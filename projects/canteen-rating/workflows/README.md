# 📚 毕业论文自动化生成工作流

## 🎯 概述

本目录包含完整的毕业论文自动化生成工作流，从源码扫描到最终成文，全流程覆盖。

## 📋 完整工作流列表（按执行顺序）

### 阶段一：项目基础分析
| 序号 | 工作流 | 功能说明 | 执行时机 |
|------|--------|---------|---------|
| 01 | [源码真相扫描](./01%20源码真相扫描.md) | 扫描项目技术栈、识别框架和依赖 | 项目开始时首次执行 |
| 02 | [实体类识别与三线表生成](./02%20实体类识别与三线表生成.md) | 从源码提取实体类，生成数据库表结构JSON | 源码扫描后 |
| 03 | [单体ER图批量生成](./03%20单体ER图批量生成.md) | 为每个实体生成独立的ER图 | 实体类识别后 |

### 阶段二：大纲与内容规划
| 序号 | 工作流 | 功能说明 | 执行时机 |
|------|--------|---------|---------|
| 04 | [大纲确认与生成](./04%20大纲确认与生成.md) | 生成论文大纲，支持4种模式（A/B/C/D） | ER图生成后 |
| 04.3 | [参考论文格式转换](./04.3%20参考论文格式转换.md) | 将Word/PDF参考论文转为Markdown | 选择模式D且有Word文件时 |
| 04.5 | [参考论文结构解析](./04.5%20参考论文结构解析.md) | 解析参考论文结构（仅模式D使用） | 04.3转换完成后 |
| 05 | [基于大纲预填内容计划](./05%20基于大纲预填内容计划.md) | 生成详细的内容计划JSON | 大纲确认后 |
| 06 | [章节切割](./06%20章节切割.md) | 将扁平化内容计划切割为独立章节文件 | 内容计划生成后 |

### 阶段三：内容与资源生成
| 序号 | 工作流 | 功能说明 | 执行时机 |
|------|--------|---------|---------|
| 07 | [智能内容生成](./07%20智能内容生成.md) | 批量生成所有章节的正文内容 | 章节切割后 |
| 08 | [资源提取与分类](./08%20资源提取与分类.md) | 提取和分类论文所需的图表资源 | 内容生成后 |
| 09 | [UML图表生成](./09%20UML图表生成.md) | 生成所有UML图表（活动图、时序图等） | 资源提取后 |

### 阶段四：论文导出与格式化 🚧
| 序号 | 工作流 | 功能说明 | 执行时机 | 状态 |
|------|--------|---------|---------|------|
| 10 | [论文格式规范解析](./10%20论文格式规范解析.md) | 从格式要求文档提取规范，生成JSON配置 | 首次导出前 | 🚧 待实现 |
| 11 | [论文导出与格式化](./11%20论文导出与格式化.md) | 将JSON内容导出为符合格式要求的Word文档 | 内容生成完成后 | 🚧 待实现 |

## 🔄 推荐执行流程

### 标准流程（不使用参考论文）
```
01 → 02 → 03 → 04(选择A/B/C) → 05 → 06 → 07 → 08 → 09 → [10] → [11]
```

### 参考论文流程（使用参考论文）
```
准备参考论文 → 01 → 02 → 03 → 04(选择D) → 04.3(转换) → 04.5(解析) → 05 → 06 → 07 → 08 → 09 → [10] → [11]
```

**注**:
- `04.3` 只在参考论文为 Word/PDF 格式时执行，若已是 MD 格式则跳过
- `[10]` 和 `[11]` 为待实现功能，当前可使用临时方案

## 🌟 特色功能

### 1. 参考论文集成（新增）
- 📂 放置参考论文到 `reference-papers/` 目录
- 🤖 自动解析章节结构和写作风格
- ✍️ 生成风格一致的论文内容
- 🎨 应用参考论文的图表命名规范

详见：[参考论文集成功能说明](./README-参考论文集成.md)

### 2. 智能内容生成
- 🧠 基于标题自动识别写作模式
- 📏 自适应章节层级和字数要求
- 🔄 批量处理，效率提升10倍+

### 3. 图表智能识别
- 🖼️ 根据章节标题自动识别图表类型
- 📊 支持多种UML图表（活动图、时序图、用例图等）
- 🎯 基于content内容生成个性化图表

## 📁 工作流文件说明

### 核心工作流
- **01-03**: 项目分析和数据库设计相关
- **04-06**: 大纲和内容规划相关
- **07-09**: 正文生成和图表生成相关
- **10-11**: 论文导出和格式化相关（🚧 待实现）

### 可选工作流
- **04.3**: 参考论文格式转换（仅模式D且有Word/PDF文件时）
- **04.5**: 参考论文结构解析（仅模式D使用）

### 辅助文档
- **README.md**: 本文档，工作流索引和使用指南
- **README-参考论文集成.md**: 参考论文功能详细说明

### 待实现工作流
- **10**: 论文格式规范解析 - 从格式文档生成JSON配置
- **11**: 论文导出与格式化 - 配置驱动的Word导出

## 🛠️ 工作流详细说明

### 01 - 源码真相扫描
**输入**: 项目源码目录
**输出**: `paper/source-truth.json`
**功能**:
- 识别前后端技术栈
- 扫描数据库实体类
- 记录框架版本信息

### 02 - 实体类识别与三线表生成
**输入**: 源码目录、source-truth.json
**输出**: `paper/assets/tables/Tab-*.json`
**功能**:
- 解析Entity类结构
- 生成标准三线表JSON
- 支持字段注释和类型映射

### 03 - 单体ER图批量生成
**输入**: 三线表JSON文件
**输出**: `paper/assets/diagrams/er/Tab-*.svg`
**功能**:
- 为每个实体生成独立ER图
- 使用PlantUML渲染
- SVG格式输出

### 04 - 大纲确认与生成
**输入**: outline.template.json
**输出**: `paper/outline.json`
**模式**:
- A: 直接使用模板
- B: 模板+AI建议
- C: 自定义大纲
- D: 基于参考论文（新增）

### 04.3 - 参考论文格式转换
**输入**: `reference-papers/*.{doc,docx,pdf}`
**输出**: `reference-papers/*.md`, `reference-papers/*_images/`
**功能**:
- Word/PDF 转 Markdown
- 自动提取文档图片
- 保留标题层级和格式
- 转换质量自动检查

**执行时机**: 仅在选择模式D且参考论文为 Word/PDF 格式时执行

### 04.5 - 参考论文结构解析
**输入**: `reference-papers/*.md`
**输出**: `paper/reference-structure.json`
**功能**:
- 解析章节层级和结构
- 提取图表分布规律
- 识别写作风格特征
- 分析字数分配模式

### 05 - 基于大纲预填内容计划
**输入**: outline.json, source-truth.json, [reference-structure.json]
**输出**: `paper/content-plan.json`
**功能**:
- 生成扁平化内容计划
- 智能图表类型识别
- 字数限制自动分配
- 应用参考论文规则（若存在）

### 06 - 章节切割
**输入**: content-plan.json
**输出**: `paper/chapters/chapter.*.json`
**功能**:
- 将扁平化JSON切割为独立文件
- 保持层级关系
- 便于后续批量处理

### 07 - 智能内容生成
**输入**: `paper/chapters/*.json`, [reference-structure.json]
**输出**: 更新chapters/*.json的content字段
**功能**:
- 批量生成章节正文
- 智能推断写作模式
- 自适应字数和风格
- 应用参考论文术语（若存在）

### 08 - 资源提取与分类
**输入**: `paper/chapters/*.json`
**输出**: 资源清单和分类
**功能**:
- 提取所有图表路径
- 分类资源类型
- 生成资源索引

### 09 - UML图表生成
**输入**: `paper/chapters/*.json`, source-truth.json, [reference-structure.json]
**输出**: `paper/assets/diagrams/uml/*.png`
**功能**:
- 生成活动图、时序图、用例图等
- 基于content内容个性化生成
- 使用PlantUML渲染
- 应用参考论文命名规范（若存在）

### 10 - 论文格式规范解析 🚧
**输入**: 学校格式要求文档（Word/PDF）
**输出**: `thesis-formats/<学校名>.json`
**功能**:
- 文档转截图（300 DPI）
- AI 分析提取格式规范
- 生成标准化 JSON 配置
- 支持多校格式管理

**状态**: 🚧 待实现（已有临时方案：玉溪师范学院本科生毕业论文格式要求.md）

### 11 - 论文导出与格式化 🚧
**输入**: `paper/chapters/chapters.json`, `paper/thesis-info.json`, `thesis-formats/*.json`
**输出**: `paper/毕业论文.docx`
**功能**:
- 配置驱动的 Word 文档生成
- 自动应用格式规范
- 生成封面、声明、目录、摘要、正文、参考文献
- 支持重复导出和调整

**状态**: 🚧 待实现（已有临时方案：export-thesis-to-word.py 硬编码版本）

## 💡 使用技巧

### 1. 首次使用建议
```bash
# 第一次使用建议按标准流程执行
# 不要跳过任何步骤，确保数据完整
```

### 2. 增量更新
```bash
# 如果只修改了某些章节内容
# 可以只重新执行 07（内容生成）和 09（图表生成）
```

### 3. 参考论文使用
```bash
# 将参考论文MD文件放入 reference-papers/
# 在04步骤选择模式D
# 后续步骤会自动应用参考论文规则
```

### 4. 批量处理优化
```bash
# Workflow 07 支持批量处理
# 建议每批4-6个章节，避免质量下降
```

## 📊 输出目录结构

```
<projectRoot>/
├── reference-papers/          # 参考论文目录（可选）
│   └── *.md
├── thesis-formats/            # 格式配置目录（10生成）
│   ├── 玉溪师范学院.json
│   └── ...
├── paper/
│   ├── source-truth.json      # 01生成
│   ├── outline.json           # 04生成
│   ├── reference-structure.json  # 04.5生成（可选）
│   ├── content-plan.json      # 05生成
│   ├── thesis-info.json       # 手动创建（论文元信息）
│   ├── 毕业论文.docx           # 11生成（最终文档）
│   ├── chapters/              # 06生成
│   │   ├── chapter.0.json
│   │   ├── chapter.1.json
│   │   └── ...
│   └── assets/
│       ├── tables/            # 02生成
│       │   └── Tab-*.json
│       ├── diagrams/
│       │   ├── er/            # 03生成
│       │   │   └── Tab-*.svg
│       │   ├── uml/           # 09生成
│       │   │   ├── activity-*.png
│       │   │   ├── usecase-*.png
│       │   │   └── ...
│       │   ├── dfd/           # 09生成（数据流图）
│       │   ├── flow/          # 09生成（流程图）
│       │   └── impl/          # 实现截图（手动添加）
│       └── plantuml/          # 09生成（PlantUML源码）
│           └── *.puml
└── source/                    # 项目源码
```

## 🔧 常见问题

### Q1: 必须按顺序执行吗？
A: 建议按顺序执行，尤其是首次使用。后续可以根据需要执行特定步骤。

### Q2: 可以跳过某些步骤吗？
A: 可以，但需要确保依赖的输入文件已存在。例如跳过02，需要手动准备三线表JSON。

### Q3: 参考论文功能必须使用吗？
A: 不是必须的。不创建 `reference-papers/` 目录或不选择模式D，系统会使用默认规则。

### Q4: 如何修改生成的内容？
A:
- 修改章节内容：直接编辑 `paper/chapters/*.json` 的 content 字段
- 修改图表：编辑 `paper/assets/plantuml/*.puml`，重新渲染
- 修改大纲：编辑 `paper/outline.json`，重新执行05-09

### Q5: 生成的图表不满意怎么办？
A:
1. 检查对应章节JSON的content字段是否清晰
2. 编辑PlantUML源码文件微调
3. 重新执行09渲染

## 🚀 性能优化建议

### 批量处理
- Workflow 07 支持批量生成，建议批次大小4-6
- Workflow 09 智能筛选需要处理的文件，自动跳过纯文本章节

### 增量更新
- 修改部分章节后，只需重新执行相关步骤
- 图表生成支持单个文件处理

### 并行执行
- 阶段一（01-03）可以部分并行
- 阶段三（07-09）可以独立执行

## 📝 版本说明

### v2.0 (2025-09-30)
- ✨ 新增参考论文集成功能
- 📝 工作流重新编号，统一命名规范
- 🔄 所有工作流向后兼容
- 📚 完善文档和使用指南

### v1.0
- 🎉 初始版本
- 📊 完整的论文生成流程
- 🤖 智能内容生成
- 🖼️ 多种图表类型支持

## 📖 更多资源

- [参考论文集成详细说明](./README-参考论文集成.md)
- [项目CLAUDE.md](../CLAUDE.md) - 项目架构说明
- [模板文件](../templates/) - 大纲和内容模板

## 💬 反馈与支持

如有问题或建议，请查看相关工作流文档或联系项目维护者。

---

**让AI帮你写论文，你专注于更有价值的工作！** 🎓✨