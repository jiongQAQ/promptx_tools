# 📐 论文格式规范解析

## 🚧 状态：待实现

本工作流尚未实现，此文档为功能预留位置。

## 🎯 目标

从学校提供的论文格式要求文档中提取格式规范，生成标准化的 JSON 配置文件，供后续导出功能使用。

**通用性设计**: 本工作流支持不同学校的格式要求文档，可适配多种论文格式标准。

## 📋 适用场景

当需要按照特定学校的论文格式要求导出 Word 文档时：
- 解析论文格式要求文档（Word/PDF）
- 提取页面设置规范（纸张、边距、页眉页脚）
- 识别字体和字号要求
- 提取样式规范（标题、正文、摘要等）
- 生成标准化的 JSON 配置文件

## 路径约定

```
<projectRoot>/
├── tools/
│   ├── 论文格式要求.docx             # 输入：学校提供的格式文档
│   └── word-to-screenshots.py       # 工具：文档转截图
├── thesis-formats/                  # 格式配置目录
│   ├── 玉溪师范学院.json
│   ├── 云南大学.json
│   └── ...
└── paper/
```

## 🔄 预期执行流程

### Phase 1: 文档准备

```bash
# 将格式要求文档放入 tools 目录
tools/
└── 玉溪师范学院本科生毕业论文格式要求.docx
```

### Phase 2: 文档转截图

```bash
# 使用 word-to-screenshots.py 转换为图片
python3 tools/word-to-screenshots.py \
  "tools/玉溪师范学院本科生毕业论文格式要求.docx" \
  "tools/format-screenshots" \
  300
```

**输出**:
- 截图文件：`tools/format-screenshots/*.png`
- 高分辨率 300 DPI，便于 AI 识别

### Phase 3: AI 分析提取

**分析维度**:
1. **页面设置**：纸张尺寸、边距、页眉页脚距离
2. **字体规范**：中文字体、英文字体、特殊字体
3. **字号对照**：初号、小初、一号...五号的 pt 值
4. **样式定义**：
   - 正文样式（字体、字号、行距、对齐、缩进）
   - 各级标题样式
   - 摘要和关键词样式
   - 图表标注样式
5. **章节配置**：封面、声明、目录、摘要、正文、参考文献
6. **特殊规则**：首行缩进、双面打印、页码格式等

### Phase 4: 生成 JSON 配置

**输出文件**: `thesis-formats/玉溪师范学院.json`

**配置结构**:
```json
{
  "school_name": "玉溪师范学院",
  "config_version": "1.0",
  "based_on_standard": "GB/T 7713-2006",
  "page_setup": {
    "paper_size": {"width_mm": 210, "height_mm": 297},
    "margins": {
      "top_cm": 2.5,
      "bottom_cm": 2.0,
      "left_cm": 2.5,
      "right_cm": 2.0
    },
    "header_footer": {
      "header_distance_cm": 1.75,
      "footer_distance_cm": 1.0
    }
  },
  "fonts": {
    "chinese": "宋体",
    "english": "Times New Roman",
    "title_chinese": "黑体",
    "school_name": "华文行楷"
  },
  "font_sizes": {
    "chu_hao": 42,
    "san_hao": 16,
    "xiao_san": 15,
    "xiao_si": 12,
    "wu_hao": 10.5
  },
  "styles": {
    "normal": {
      "font": "chinese",
      "size": "xiao_si",
      "line_spacing": 1.25,
      "alignment": "justify",
      "first_line_indent": 0
    },
    "heading_1": {
      "font": "chinese",
      "size": "san_hao",
      "bold": true,
      "space_before_pt": 12,
      "space_after_pt": 6
    }
  },
  "sections": {
    "cover": {"enabled": true},
    "declarations": {"enabled": true},
    "toc": {"enabled": true},
    "abstract_cn": {"title": "摘要"},
    "abstract_en": {"title": "Abstract"},
    "references": {"title": "参考文献", "standard": "GB/T 7714-2015"}
  },
  "special_rules": {
    "no_first_line_indent": true,
    "double_sided_print": true,
    "roman_numerals_for_abstract": true,
    "max_keywords": 5
  }
}
```

## 📊 配置文件复用

**配置优先级**:
```
项目自定义配置 (thesis-formats/custom.json)
    ↓
学校标准配置 (thesis-formats/玉溪师范学院.json)
    ↓
默认配置 (代码内置)
```

**跨项目复用**:
- 同一学校的多个项目可共享格式配置
- 配置文件可独立维护和版本管理
- 支持配置继承和覆盖

## 🔗 相关工具

### 已实现工具
- `tools/word-to-screenshots.py` - Word文档转截图
- `玉溪师范学院本科生毕业论文格式要求.md` - 已提取的格式要求（人类可读）

### 待实现功能
- JSON 配置文件生成器
- 配置验证工具
- 格式配置加载器

## 📌 下游工作流

本工作流的输出将被以下工作流使用：
- **Workflow 11**: 论文导出与格式化

## 🚀 实现优先级

**P1 核心功能**:
- ✅ 已有格式要求 MD 文档（玉溪师范学院）
- ⏳ JSON 配置文件生成
- ⏳ 配置加载和验证

**P2 扩展功能**:
- ⏳ 多校格式支持
- ⏳ 配置继承机制
- ⏳ 可视化配置编辑器

## 💡 使用建议

在实现本工作流前，可以采用以下临时方案：
1. 直接使用已提取的 `玉溪师范学院本科生毕业论文格式要求.md`
2. 在导出代码中硬编码格式设置
3. 待本工作流实现后，再迁移到配置驱动模式

---

**最后更新**: 2025-09-30
**依赖工具**: word-to-screenshots.py
**相关文档**: 玉溪师范学院本科生毕业论文格式要求.md