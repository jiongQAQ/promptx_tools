@startuml
!theme plain
skinparam linetype ortho

entity "users (用户表)" as User {
  *id : BIGINT <<PK>>
  --
  username : VARCHAR(50)
  password : VARCHAR(255)
  role : VARCHAR(20)
  created_time : DATETIME
  updated_time : DATETIME
  is_deleted : TINYINT(1)
}

entity "canteens (食堂表)" as Canteen {
  *id : BIGINT <<PK>>
  --
  name : VARCHAR(100)
  location : VARCHAR(200)
  open_time : VARCHAR(50)
  close_time : VARCHAR(50)
  created_time : DATETIME
  updated_time : DATETIME
  is_deleted : TINYINT(1)
}

entity "stalls (档口表)" as Stall {
  *id : BIGINT <<PK>>
  --
  *canteen_id : BIGINT <<FK>>
  name : VARCHAR(100)
  description : VARCHAR(500)
  created_time : DATETIME
  updated_time : DATETIME
  is_deleted : TINYINT(1)
}

entity "dishes (菜品表)" as Dish {
  *id : BIGINT <<PK>>
  --
  *stall_id : BIGINT <<FK>>
  name : VARCHAR(100)
  price : DECIMAL(10,2)
  image_path : VARCHAR(255)
  average_rating : DOUBLE
  rating_count : INTEGER
  created_time : DATETIME
  updated_time : DATETIME
  is_deleted : TINYINT(1)
}

entity "ratings (评价表)" as Rating {
  *id : BIGINT <<PK>>
  --
  *user_id : BIGINT <<FK>>
  *dish_id : BIGINT <<FK>>
  score : TINYINT
  comment : VARCHAR(1000)
  created_time : DATETIME
  updated_time : DATETIME
  is_deleted : TINYINT(1)
}

entity "complaints (投诉表)" as Complaint {
  *id : BIGINT <<PK>>
  --
  *user_id : BIGINT <<FK>>
  *stall_id : BIGINT <<FK>>
  type : VARCHAR(50)
  content : VARCHAR(1000)
  status : VARCHAR(20)
  admin_reply : VARCHAR(1000)
  created_time : DATETIME
  updated_time : DATETIME
  is_deleted : TINYINT(1)
}

entity "sensitive_words (敏感词表)" as SensitiveWord {
  *id : BIGINT <<PK>>
  --
  word : VARCHAR(100)
  level : VARCHAR(20)
  created_time : DATETIME
  updated_time : DATETIME
  is_deleted : TINYINT(1)
}

Canteen ||--o{ Stall : "1对多"
Stall ||--o{ Dish : "1对多"
User ||--o{ Rating : "1对多"
Dish ||--o{ Rating : "1对多"
User ||--o{ Complaint : "1对多"
Stall ||--o{ Complaint : "1对多"

@enduml