{
  "id": "3.4.2",
  "title": "数据库逻辑设计",
  "text": "以总体ER图展示用户、菜品、评分、档口、投诉等实体间的关联关系，明确主外键约束与数据一致性设计。",
  "imagePath": "/Users/jiongjiong/Documents/a_git_project/promptx_tools/projects/canteen-rating/paper/pngs/er-overview.png",
  "imageLabel": "图3-10 数据库总体ER图",
  "prompt": "请基于源码和论文主题，撰写《数据库逻辑设计》的正文，要求学术化表达，详细说明数据库的逻辑结构设计，并在正文中结合总体ER图描述实体间的关联关系和约束条件，确保涵盖text中的要点，字数参考word_limit配置。",
  "word_limit": 250,
  "content": "数据库逻辑设计基于实体关系模型，通过总体ER图清晰展示了系统核心实体间的关联关系和约束条件。在实体关系设计中，用户实体与评分实体建立一对多关系，一个用户可以提交多个评分，但每个评分只能属于一个用户，通过ratings表的user_id外键实现关联。菜品实体与评分实体同样为一对多关系，一个菜品可以收到多个评分，通过dish_id外键建立关联。档口实体与菜品实体构成一对多关系，一个档口可以提供多个菜品，通过dishes表的stall_id外键实现层级管理。用户实体与投诉实体建立一对多关系，用户可以提交多个投诉建议，通过complaints表的user_id外键关联。在约束条件设计方面，实施多层次的数据一致性控制：主键约束确保实体唯一性，外键约束保证引用完整性，唯一约束防止重复数据，非空约束确保关键字段完整性。特别地，在ratings表中建立(user_id, dish_id)复合唯一约束，防止用户对同一菜品重复评分。通过ON DELETE CASCADE和ON UPDATE CASCADE设置级联操作规则，确保数据删除和更新的一致性。索引设计覆盖外键字段和频繁查询字段，提升关联查询性能。",
  "docx_style": {
    "preset": "academic"
  }
}