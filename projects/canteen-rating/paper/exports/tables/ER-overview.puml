@startuml

!define ENTITY(name, desc) entity name as "name\n(desc)"
!define RELATION(e1, e2, desc) e1 }|--|| e2 : desc

skinparam backgroundColor #FFFFFF
skinparam class {
  BackgroundColor #E8F4FD
  BorderColor #4A90E2
  ArrowColor #2C5F8A
}

ENTITY(users, 用户表) {
  * id : BIGINT <<PK>>
  --
  username : VARCHAR(255)
  real_name : VARCHAR(255)
  password : VARCHAR(255)
  role : VARCHAR(50)
  created_time : DATETIME
  updated_time : DATETIME
  is_deleted : INT
}

ENTITY(canteens, 食堂表) {
  * id : BIGINT <<PK>>
  --
  name : VARCHAR(255)
  location : VARCHAR(255)
  open_time : VARCHAR(50)
  close_time : VARCHAR(50)
  created_time : DATETIME
  updated_time : DATETIME
  is_deleted : INT
}

ENTITY(stalls, 档口表) {
  * id : BIGINT <<PK>>
  --
  * canteen_id : BIGINT <<FK>>
  name : VARCHAR(255)
  description : TEXT
  created_time : DATETIME
  updated_time : DATETIME
  is_deleted : INT
}

ENTITY(dishes, 菜品表) {
  * id : BIGINT <<PK>>
  --
  * stall_id : BIGINT <<FK>>
  name : VARCHAR(255)
  publish_date : DATE
  price : DECIMAL(10,2)
  description : TEXT
  image_path : VARCHAR(500)
  average_rating : DECIMAL(3,2)
  rating_count : INT
  created_time : DATETIME
  updated_time : DATETIME
  is_deleted : INT
}

ENTITY(ratings, 评价表) {
  * id : BIGINT <<PK>>
  --
  * user_id : BIGINT <<FK>>
  * dish_id : BIGINT <<FK>>
  score : INT
  comment : TEXT
  image_path : VARCHAR(500)
  rating_date : DATE
  created_time : DATETIME
  updated_time : DATETIME
  is_deleted : INT
}

ENTITY(complaints, 投诉建议表) {
  * id : BIGINT <<PK>>
  --
  * user_id : BIGINT <<FK>>
  stall_id : BIGINT <<FK>>
  type : VARCHAR(20)
  title : VARCHAR(255)
  content : TEXT
  status : VARCHAR(20)
  admin_reply : TEXT
  created_time : DATETIME
  updated_time : DATETIME
  is_deleted : INT
}

ENTITY(sensitive_words, 敏感词表) {
  * id : BIGINT <<PK>>
  --
  word : VARCHAR(255)
  category : VARCHAR(50)
  status : VARCHAR(20)
  created_time : DATETIME
  updated_time : DATETIME
  is_deleted : INT
}

' Relations
canteens ||--o{ stalls : "contains"
stalls ||--o{ dishes : "offers"
dishes ||--o{ ratings : "receives"
users ||--o{ ratings : "creates"
users ||--o{ complaints : "submits"
stalls ||--o{ complaints : "relates to"

@enduml