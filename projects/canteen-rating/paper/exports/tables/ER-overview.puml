@startuml
!theme plain

entity "users (用户表)" as users {
  * **id** : BIGINT <<PK>>
  --
  username : VARCHAR(255)
  real_name : VARCHAR(255)
  password : VARCHAR(255)
  role : VARCHAR(50)
  created_time : DATETIME
  updated_time : DATETIME
  is_deleted : INT
}

entity "canteens (食堂表)" as canteens {
  * **id** : BIGINT <<PK>>
  --
  name : VARCHAR(255)
  location : VARCHAR(255)
  open_time : VARCHAR(50)
  close_time : VARCHAR(50)
  created_time : DATETIME
  updated_time : DATETIME
  is_deleted : INT
}

entity "stalls (档口表)" as stalls {
  * **id** : BIGINT <<PK>>
  --
  * canteen_id : BIGINT <<FK>>
  name : VARCHAR(255)
  description : VARCHAR(500)
  created_time : DATETIME
  updated_time : DATETIME
  is_deleted : INT
}

entity "dishes (菜品表)" as dishes {
  * **id** : BIGINT <<PK>>
  --
  * stall_id : BIGINT <<FK>>
  name : VARCHAR(255)
  publish_date : DATE
  price : DECIMAL(10,2)
  description : VARCHAR(500)
  image_path : VARCHAR(255)
  average_rating : DECIMAL(3,2)
  rating_count : INT
  created_time : DATETIME
  updated_time : DATETIME
  is_deleted : INT
}

entity "ratings (评价表)" as ratings {
  * **id** : BIGINT <<PK>>
  --
  * user_id : BIGINT <<FK>>
  * dish_id : BIGINT <<FK>>
  score : INT
  comment : TEXT
  image_path : VARCHAR(255)
  rating_date : DATE
  created_time : DATETIME
  updated_time : DATETIME
  is_deleted : INT
}

entity "complaints (投诉建议表)" as complaints {
  * **id** : BIGINT <<PK>>
  --
  * user_id : BIGINT <<FK>>
  stall_id : BIGINT <<FK>>
  type : VARCHAR(50)
  title : VARCHAR(255)
  content : TEXT
  status : VARCHAR(50)
  admin_reply : TEXT
  created_time : DATETIME
  updated_time : DATETIME
  is_deleted : INT
}

entity "sensitive_words (敏感词表)" as sensitive_words {
  * **id** : BIGINT <<PK>>
  --
  word : VARCHAR(255)
  level : VARCHAR(50)
  created_time : DATETIME
  updated_time : DATETIME
  is_deleted : INT
}

' Relationships
canteens ||--o{ stalls : "一个食堂有多个档口"
stalls ||--o{ dishes : "一个档口有多个菜品"
users ||--o{ ratings : "一个用户有多个评价"
dishes ||--o{ ratings : "一个菜品有多个评价"
users ||--o{ complaints : "一个用户有多个投诉建议"
stalls ||--o{ complaints : "一个档口有多个投诉建议"

@enduml