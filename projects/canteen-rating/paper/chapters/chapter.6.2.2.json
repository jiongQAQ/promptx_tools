{
  "id": "6.2.2",
  "title": "食堂与档口管理测试",
  "text": "食堂与档口管理模块测试覆盖食堂信息和档口信息的增删改查功能。测试用例包括：新增食堂（正常/缺少必填字段/重复名称）、修改食堂信息、删除食堂（含档口/不含档口）、查询食堂列表（分页/筛选）、新增档口（正常/所属食堂不存在）、档口关联查询等。测试过程验证了业务逻辑的正确性，如删除食堂时检查是否存在关联档口，确保数据完整性。发现并修复了档口关联查询时外键索引缺失导致的性能问题。所有测试用例执行结果如下表所示，共设计12个测试用例，全部通过。",
  "word_limit": 220,
  "tablePath": "${tables}/test-canteen-stall.json",
  "content": "食堂与档口管理模块的测试重点是验证信息管理功能的完整性和数据层级关系的正确性。\n\n测试用例覆盖了食堂和档口信息的增删改查以及关联关系的验证。在食堂管理测试中，设计了新增食堂正常场景（填写完整信息，保存成功）、缺少必填字段场景（食堂名称为空，提示错误）、重复名称场景（食堂名称已存在，提示重复）、修改食堂信息（更新成功，数据正确保存）、删除食堂测试（食堂下没有档口时可以删除，有档口时拒绝删除并提示先删除档口）、查询食堂列表（分页参数正确，数据按创建时间倒序）、按名称模糊搜索（输入关键词返回匹配结果）、按状态筛选（只返回指定状态的食堂）等测试用例。\n\n在档口管理测试中，设计了新增档口正常场景、所属食堂不存在场景（提示食堂ID无效）、修改档口信息、删除档口、按食堂查询档口列表（返回指定食堂下的所有档口）、档口关联查询（档口信息中包含所属食堂名称）等测试用例。特别测试了级联删除的业务逻辑，验证在删除食堂前必须先删除其下所有档口，数据完整性得到保证。\n\n测试过程中发现并修复了档口关联查询时性能问题。最初的实现在查询档口列表时，对每个档口都单独查询一次食堂信息，导致N+1查询问题，当档口数量较多时性能较差。优化方案是在Service层先查询所有档口，提取所有canteen_id，批量查询食堂信息，然后在内存中进行关联组装，将查询次数从N+1次优化为2次，性能显著提升。在canteen_id字段上添加索引，进一步加速关联查询。\n\n所有测试用例执行结果如下表所示，共设计了12个测试用例，覆盖了食堂和档口管理的主要功能和边界情况，经过问题修复和优化，所有测试用例全部通过，验证了模块的功能正确性和性能表现。"
}