{
  "id": "4.2.3",
  "title": "物理结构设计",
  "text": "数据库物理设计阶段确定具体的表结构实现细节，包括字段数据类型、长度、是否为空、默认值、索引类型等。本系统使用InnoDB存储引擎，字符集采用utf8mb4支持emoji表情，排序规则为utf8mb4_unicode_ci。主键字段id采用BIGINT类型自增，字符串字段根据业务需要设置合适的VARCHAR长度（如username为50字符，content为1000字符），布尔类型字段使用TINYINT(1)，时间字段使用DATETIME类型。外键字段建立普通索引加速关联查询，常用查询字段（如status、create_time）建立组合索引。下面列出各表的详细物理结构设计。",
  "word_limit": 220,
  "content": "数据库物理设计阶段是数据库设计的最后阶段，主要任务是在逻辑设计的基础上，确定数据库的具体物理实现细节，包括存储引擎的选择、字符集和排序规则的设置、字段数据类型和长度的确定、索引类型的选择等，以达到最佳的存储效率和查询性能。\n\n在存储引擎选择上，本系统所有表均采用InnoDB存储引擎。InnoDB是MySQL的默认存储引擎，支持事务（ACID特性）、行级锁定和外键约束，能够保证数据的一致性和完整性，适合并发访问和需要事务支持的应用场景。相比MyISAM等其他存储引擎，InnoDB在数据安全性和并发性能上具有明显优势。\n\n在字符集和排序规则的设置上，系统采用utf8mb4字符集和utf8mb4_unicode_ci排序规则。utf8mb4是utf8字符集的超集，完全支持Unicode字符，包括emoji表情符号等四字节字符，能够满足现代Web应用对字符集的需求。utf8mb4_unicode_ci是不区分大小写的排序规则，在字符串比较时忽略大小写，符合一般应用的需求。\n\n在字段数据类型的选择上，系统遵循以下原则：主键id字段统一采用BIGINT类型，占用8字节，取值范围足够大，支持自动递增；字符串字段根据业务需要选择合适的VARCHAR长度，如username字段设置为VARCHAR(50)，password字段设置为VARCHAR(255)以存储加密后的密码，content评价内容字段设置为VARCHAR(1000)，text长文本字段设置为TEXT类型；数值字段根据取值范围选择合适的类型，如price价格字段使用DECIMAL(10,2)保证精度，score评分字段使用TINYINT，status状态字段使用TINYINT；布尔类型字段使用TINYINT(1)，0表示false，1表示true；时间字段统一使用DATETIME类型，精确到秒。\n\n在字段约束的设置上，主键字段设置PRIMARY KEY约束并设置AUTO_INCREMENT自动递增；外键字段虽然不设置物理外键约束（为了提高性能和灵活性），但在应用层保证引用完整性；非空字段设置NOT NULL约束，如用户名、密码等必填字段；具有唯一性要求的字段设置UNIQUE约束，如用户名username字段；字段设置合理的默认值，如status字段默认值为1表示正常状态，is_deleted字段默认值为0表示未删除。\n\n在索引设计上，除主键自动创建聚簇索引外，在外键字段上创建普通索引（INDEX），使用B+Tree索引结构，加速关联查询和连接操作。在常用查询条件字段上创建索引，提升WHERE子句的查询效率。对于某些组合查询场景，创建联合索引（Composite Index），索引列的顺序遵循最左前缀原则，将区分度高的列放在前面。对于需要全文检索的字段，如评价内容，可以考虑使用FULLTEXT索引，但本系统采用应用层实现的敏感词过滤，未使用MySQL的全文索引。\n\n下面列出系统各表的详细物理结构设计，包括表名、字段名、数据类型、长度、是否为空、默认值、备注等信息，为数据库的创建和实现提供完整的参考。",
  "items": [
    {
      "title": "用户表（user）",
      "text": "用户表（user），主要存储了本系统用户基本信息和认证信息的相关数据，其中包含用户ID（id）、用户名（username）、密码（password）、昵称（nickname）、头像（avatar）、邮箱（email）、手机号（phone）、角色（role）、状态（status）、创建时间（create_time）、更新时间（update_time）、逻辑删除标记（is_deleted）。用户表的数据库设计如下表，表4-1 用户表 user所示。",
      "word_limit": 70,
      "tablePath": "${tables}/Tab-user.json"
    },
    {
      "title": "食堂表（canteen）",
      "text": "食堂表（canteen），主要存储了本系统食堂基本信息的相关数据，其中包含食堂ID（id）、食堂名称（name）、位置（location）、简介（description）、图片（image）、营业时间（opening_hours）、联系电话（phone）、状态（status）、创建时间（create_time）、更新时间（update_time）、逻辑删除标记（is_deleted）。食堂表的数据库设计如下表，表4-2 食堂表 canteen所示。",
      "word_limit": 70,
      "tablePath": "${tables}/Tab-canteen.json"
    },
    {
      "title": "档口表（stall）",
      "text": "档口表（stall），主要存储了本系统档口信息的相关数据，其中包含档口ID（id）、档口名称（name）、所属食堂ID（canteen_id）、简介（description）、图片（image）、位置（location）、联系方式（contact）、状态（status）、创建时间（create_time）、更新时间（update_time）、逻辑删除标记（is_deleted）。档口表的数据库设计如下表，表4-3 档口表 stall所示。",
      "word_limit": 70,
      "tablePath": "${tables}/Tab-stall.json"
    },
    {
      "title": "菜品表（dish）",
      "text": "菜品表（dish），主要存储了本系统菜品信息的相关数据，其中包含菜品ID（id）、菜品名称（name）、所属档口ID（stall_id）、分类（category）、价格（price）、图片（image）、描述（description）、是否推荐（is_recommended）、上架状态（status）、创建时间（create_time）、更新时间（update_time）、逻辑删除标记（is_deleted）。菜品表的数据库设计如下表，表4-4 菜品表 dish所示。",
      "word_limit": 70,
      "tablePath": "${tables}/Tab-dish.json"
    },
    {
      "title": "评价表（rating）",
      "text": "评价表（rating），主要存储了本系统用户评价信息的相关数据，其中包含评价ID（id）、用户ID（user_id）、菜品ID（dish_id）、评分（score）、评价内容（content）、图片（images）、审核状态（status）、创建时间（create_time）、更新时间（update_time）、逻辑删除标记（is_deleted）。评价表的数据库设计如下表，表4-5 评价表 rating所示。",
      "word_limit": 70,
      "tablePath": "${tables}/Tab-rating.json"
    },
    {
      "title": "投诉表（complaint）",
      "text": "投诉表（complaint），主要存储了本系统用户投诉信息的相关数据，其中包含投诉ID（id）、用户ID（user_id）、投诉类型（type）、投诉对象ID（target_id）、投诉内容（content）、图片（images）、处理状态（status）、处理结果（result）、处理时间（handle_time）、创建时间（create_time）、更新时间（update_time）、逻辑删除标记（is_deleted）。投诉表的数据库设计如下表，表4-6 投诉表 complaint所示。",
      "word_limit": 70,
      "tablePath": "${tables}/Tab-complaint.json"
    },
    {
      "title": "敏感词表（sensitive_word）",
      "text": "敏感词表（sensitive_word），主要存储了本系统敏感词管理的相关数据，其中包含敏感词ID（id）、敏感词内容（word）、类型（type）、状态（status）、创建时间（create_time）、更新时间（update_time）、逻辑删除标记（is_deleted）。敏感词表的数据库设计如下表，表4-7 敏感词表 sensitive_word所示。",
      "word_limit": 70,
      "tablePath": "${tables}/Tab-sensitive_word.json"
    }
  ]
}