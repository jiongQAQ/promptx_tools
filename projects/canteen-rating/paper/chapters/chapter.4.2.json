{
  "id": "4.2",
  "title": "数据库详细设计",
  "items": [
    {
      "title": "用户表",
      "text": "用户表，主要储存了本系统用户认证管理的相关信息，其中包含用户ID (id)、学号工号 (username)、密码 (password)、姓名 (name)、角色 (role)、启用状态 (enabled)、创建时间 (created_time)、更新时间 (updated_time)，用户表的数据库设计如下表，表4-1 用户表 users所示。",
      "tablePath": "${tables}/Tab-users.json",
      "word_limit": 70,
      "content": "用户表采用严格的数据约束和安全设计。id主键自增，username字段设置唯一索引保证登录标识的唯一性，password采用VARCHAR(255)存储BCrypt加密密码，role字段使用枚举类型限制取值为'STUDENT'或'ADMIN'，enabled字段默认值为trueenabled，created_time和updated_time采用DATETIME类型支持自动更新。"
    },
    {
      "title": "食堂表",
      "text": "食堂表，主要储存了本系统食堂管理的相关信息，其中包含食堂ID (id)、食堂名称 (name)、食堂描述 (description)、食堂位置 (location)、营业时间 (business_hours)、创建时间 (created_time)、更新时间 (updated_time)，食堂表的数据库设计如下表，表4-2 食堂表 canteen所示。",
      "tablePath": "${tables}/Tab-canteen.json",
      "word_limit": 70,
      "content": "食堂表体现了地理位置和时间管理的业务特性。name字段设置不为空约束，description支持长文本存储，location采用VARCHAR(500)支持详细地址，business_hours使用JSON格式灵活存储复杂的营业时间安排，包括工作日、周末和节假日的不同设置。表结构设计支持未来的多校区扩展需求。"
    },
    {
      "title": "档口表",
      "text": "档口表，主要储存了本系统档口管理的相关信息，其中包含档口ID (id)、档口名称 (name)、档口描述 (description)、所属食堂ID (canteen_id)、创建时间 (created_time)、更新时间 (updated_time)，档口表的数据库设计如下表，表4-3 档口表 stall所示。",
      "tablePath": "${tables}/Tab-stall.json",
      "word_limit": 70,
      "content": "档口表建立了与食堂表的强关联关系。canteen_id为外键，引用canteen表的id字段，设置了级联更新约束。name在同一食堂内必须唯一，通过复合索引(canteen_id, name)实现。description支持富文本内容，包括档口特色、主打菜品等介绍信息，为用户选择提供参考。"
    },
    {
      "title": "菜品表",
      "text": "菜品表，主要储存了本系统菜品管理的相关信息，其中包含菜品ID (id)、菜品名称 (name)、菜品描述 (description)、价格 (price)、所属档口ID (stall_id)、菜品图片 (image_url)、创建时间 (created_time)、更新时间 (updated_time)，菜品表的数据库设计如下表，表4-4 菜品表 dish所示。",
      "tablePath": "${tables}/Tab-dish.json",
      "word_limit": 70,
      "content": "菜品表作为核心业务表，设计重点关注数据精度和业务规则。stall_id外键关联档口表，price采用DECIMAL(10,2)类型保证货币计算精度，image_url存储图片访问路径且支持CDN加速。表中增加了is_deleted逻辑删除字段和avg_rating评分统计字段，支持高效的评价查询和排序。"
    },
    {
      "title": "评价表",
      "text": "评价表，主要储存了本系统菜品评价的相关信息，其中包含评价ID (id)、用户ID (user_id)、菜品ID (dish_id)、评分 (score)、评价内容 (content)、评价时间 (rating_time)、创建时间 (created_time)、更新时间 (updated_time)，评价表的数据库设计如下表，表4-5 评价表 rating所示。",
      "tablePath": "${tables}/Tab-rating.json",
      "word_limit": 70,
      "content": "评价表作为系统核心业务数据表，采用复合主键设计。user_id和dish_id建立复合索引防止重复评价，score字段设置检查约束(1-5)保证评分有效性，content支持长文本存储且建立全文索引支持关键词搜索。rating_time独立于系统时间，记录用户实际评价的时间点，支持时间维度的数据分析。"
    },
    {
      "title": "投诉建议表",
      "text": "投诉建议表，主要储存了本系统投诉建议处理的相关信息，其中包含投诉ID (id)、用户ID (user_id)、投诉类型 (type)、投诉标题 (title)、投诉内容 (content)、处理状态 (status)、管理员回复 (admin_reply)、创建时间 (created_time)、更新时间 (updated_time)，投诉建议表的数据库设计如下表，表4-6 投诉建议表 complaint所示。",
      "tablePath": "${tables}/Tab-complaint.json",
      "word_limit": 70,
      "content": "投诉建议表实现了工作流管理和状态追踪。type字段使用枚举值区分投诉类型，status字段记录处理状态且设置默认值'PENDING'，admin_reply支持富文本回复内容。表中增加了priority优先级字段和assigned_admin_id分配管理员字段，支持精细化的投诉处理流程管理。"
    },
    {
      "title": "敏感词表",
      "text": "敏感词表，主要储存了本系统内容审核的相关信息，其中包含敏感词ID (id)、敏感词内容 (word)、词性类型 (type)、启用状态 (enabled)、创建时间 (created_time)、更新时间 (updated_time)，敏感词表的数据库设计如下表，表4-7 敏感词表 sensitive_word所示。",
      "tablePath": "${tables}/Tab-sensitive_word.json",
      "word_limit": 70,
      "content": "敏感词表为内容安全提供基础数据支持。word字段设置唯一索引防止重复，type字段区分词汇类型支持分类管理，enabled字段支持热更新功能。表设计支持高频词汇的快速匹配，采用前缀索引和全文检索相结合的方式提高过滤效率，为系统内容审核提供高效可靠的数据支持。"
    }
  ]
}