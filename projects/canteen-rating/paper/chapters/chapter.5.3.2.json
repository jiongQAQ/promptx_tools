{
  "id": "5.3.2",
  "title": "实现过程",
  "text": "菜品管理模块的后端实现主要在菜品管理控制器和用户菜品控制器中，前者提供管理员接口，后者提供用户查询接口。菜品管理控制器提供管理接口的增删改查功能，支持分页查询、条件筛选、批量删除。服务实现类实现业务逻辑，包括菜品信息校验、档口关联验证、图片路径处理等。前端管理界面使用表格组件展示菜品列表，表单组件实现菜品编辑表单，上传组件支持图片上传并预览，开关组件实现上下架快速切换。用户端使用卡片组件展示菜品卡片，点击卡片查看详情，显示菜品图片、价格、评分、评价数等信息。菜品列表支持按档口筛选、按分类过滤、按价格排序。实现效果如图所示，展示了菜品管理界面和用户浏览界面。",
  "word_limit": 300,
  "imagePath": "${impl}/impl-dish.png",
  "content": "菜品管理模块的实现分为管理员端和用户端两部分，后端提供两套RESTful接口分别服务于管理功能和查询功能。\n\n后端实现主要包括菜品管理控制器（管理员接口）和用户菜品控制器（用户接口）两个控制器。菜品管理控制器使用REST控制器注解和路径映射注解，提供完整的菜品管理接口。实现POST接口处理菜品新增，接收数据传输对象，在服务层验证所属档口是否存在、菜品名称是否重复，验证通过后保存菜品信息。实现PUT接口处理菜品修改，更新菜品的各项属性。实现DELETE接口支持单个删除和批量删除，批量删除接收菜品ID数组，循环调用删除方法。实现GET接口处理列表查询，支持分页参数和查询条件（档口ID、分类、状态、关键词），使用查询构造器构造复杂查询条件，调用分页方法返回分页对象。实现PATCH接口快速切换上下架状态，只更新状态字段，提升操作效率。\n\n用户菜品控制器提供用户查询接口。实现列表查询接口，只返回上架状态的菜品，支持按档口、分类筛选，支持按价格、评分、评价数排序。查询结果的视图对象中，除菜品基本信息外，还包括平均评分和评价总数，这两个字段通过关联查询评价表统计得出。实现菜品详情查询接口，返回菜品的完整信息和最新的评价列表。\n\n服务实现类实现业务逻辑层。在保存菜品时，处理图片上传逻辑，调用文件服务将图片文件保存到服务器，获取图片URL路径存入图片字段。在更新菜品时，如果更换了图片，需要删除旧图片文件，避免服务器存储浪费。在批量导入时，解析Excel文件，逐行读取菜品数据，验证数据格式，批量插入数据库，使用批量保存方法提升插入效率。在计算菜品平均分时，使用SQL聚合函数统计评价表中该菜品的评分数据，更新到菜品表的对应字段。\n\n前端管理界面实现使用Vue 3和Element Plus。菜品列表页面使用表格组件，配置列包括菜品名称、所属档口、分类、价格、状态、评分、评价数、操作等。价格列使用格式化函数格式化为货币格式，状态列使用标签组件显示上架/下架标签，评分列使用评分组件以只读模式显示星级。操作列提供编辑、删除、上下架切换按钮，使用按钮组件实现。菜品编辑对话框使用对话框组件，宽度设置为600px，表单使用表单组件，配置验证规则进行表单验证。档口选择使用选择器组件，加载所有档口数据供选择。分类选择也使用选择器组件，选项为预定义的分类列表。价格输入使用数字输入框组件，设置精度为2，最小值为0.01，确保价格格式正确。描述输入使用文本域输入组件，设置最大长度为500限制字数。图片上传使用上传组件，配置列表类型为卡片形式展示，限制文件大小不超过2MB，支持图片预览功能。上下架状态使用开关组件，点击后立即调用API更新状态，无需打开编辑对话框，提升了操作便捷性。\n\n用户端界面使用卡片组件展示菜品卡片，卡片包含菜品图片、名称、价格、评分等关键信息。使用CSS Grid布局实现响应式的卡片网格，适配不同屏幕尺寸。菜品图片使用图片组件，支持点击预览大图。评分使用评分组件只读显示，评价数使用文字标注。点击卡片跳转到菜品详情页，详情页顶部展示菜品大图和基本信息，下方展示评价列表，使用空状态组件处理无评价的情况。\n\n模块实现效果如图所示，展示了菜品管理界面和用户浏览界面的实际效果。管理界面展示了菜品列表、编辑对话框、图片上传和上下架控制功能。用户界面展示了菜品卡片布局、详情页面和评价展示，验证了模块功能的完整实现。",
  "docx_type": "subsection_title",
  "docx_type_text": "body_text",
  "docx_type_desc": "body_text"
}