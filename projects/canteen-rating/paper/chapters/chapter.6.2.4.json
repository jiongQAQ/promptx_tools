{
  "id": "6.2.4",
  "title": "评价管理测试",
  "text": "评价管理模块测试是功能测试的重点，覆盖评价提交、敏感词过滤、审核流程、评分统计等关键功能。测试用例包括：提交评价（正常/包含敏感词/空内容）、上传评价图片（正常/数量超限）、查询评价列表（按菜品/按用户/分页）、管理员审核评价、删除评价、评分统计准确性、敏感词检测性能等。测试过程重点验证了敏感词DFA算法的准确性和性能，以及评分统计的实时性和准确性。发现并修复了高并发评价提交时评分统计不准确的问题，通过数据库行锁解决。所有测试用例执行结果如下表所示，共设计13个测试用例，全部通过。",
  "word_limit": 220,
  "tablePath": "${tables}/test-rating.json",
  "content": "评价管理模块测试是功能测试的重点，评价功能作为系统的核心业务，其正确性和稳定性直接影响系统的使用价值。\n\n测试用例覆盖了评价提交、敏感词过滤、审核流程、评分统计等关键功能。在评价提交测试中，设计了正常提交场景（填写评分和评价内容，提交成功）、包含敏感词场景（评价内容包含敏感词，状态设为待审核）、空内容场景（评价内容为空，提示必填）、重复评价场景（同一用户对同一菜品重复评价，提示已评价）等测试用例。在评价图片上传测试中，设计了正常上传场景（图片格式和大小符合要求，上传成功）、数量超限场景（上传4张图片，超过3张限制，提示错误）等测试用例。\n\n在敏感词过滤测试中，重点验证了DFA算法的准确性和性能。构造包含敏感词的评价内容进行测试，验证系统能够准确识别敏感词并将评价标记为待审核。构造包含敏感词变形（如在敏感词中插入空格、符号等）的内容进行测试，验证系统的防绕过能力。使用包含1000个敏感词的词库，对一段500字的评价内容进行检测，耗时约5毫秒，验证了DFA算法的高效性，性能满足实时检测的要求。\n\n在管理员审核测试中，设计了审核通过场景（待审核评价审核通过，状态变为已发布，对外可见）、审核拒绝场景（待审核评价被拒绝，状态变为已拒绝，不对外显示）等测试用例。在评价删除测试中，验证了用户只能删除自己的评价，管理员可以删除任何评价，删除后评价逻辑删除，评分统计正确更新。\n\n在评分统计准确性测试中，设计了多种场景验证统计逻辑。提交10条评分分别为1-5星的评价，验证平均分计算正确（应为3.0）。删除一条5星评价后，验证平均分重新计算正确（应降低）。审核通过一条待审核评价后，验证评分统计正确包含该评价。性能测试方面，测试了高并发评价提交时的评分统计准确性，模拟100个用户同时提交评价，验证最终的评分统计数据是否准确。测试过程中发现了并发问题：多个评价同时提交时，评分统计可能出现不准确的情况，原因是多个事务同时读取和更新dish表的评分字段，存在并发冲突。解决方案是在更新评分时使用数据库行锁（SELECT FOR UPDATE）或使用原子更新操作，确保并发安全。\n\n所有测试用例执行结果如下表所示，共设计了13个测试用例，覆盖了评价管理的主要功能和性能要求，经过问题修复，所有测试用例全部通过，验证了评价管理模块的功能正确性、安全性和并发性能。",
  "docx_type": "subsection_title",
  "docx_type_text": "body_text",
  "docx_type_desc": "body_text"
}