{
  "id": "4.3.1",
  "title": "用户管理模块设计",
  "word_limit": 500,
  "text": "placeholder",
  "imagePath": "${uml}/activity-user.png",
  "imagePathSequence": "${uml}/sequence-user.png",
  "_note": "三级章节，必须有text，包含活动图和时序图",
  "content": "用户管理模块是系统的基础模块，为用户提供注册、登录、信息管理等功能。模块的活动流程如图4-1所示，服务间调用时序如图4-2所示。\n\n用户注册功能允许新用户创建账号。用户填写手机号、密码等信息提交注册请求，系统首先验证手机号格式的合法性，然后发送短信验证码到用户手机。用户输入验证码后，系统验证验证码的正确性和有效期。验证通过后，系统检查手机号是否已被注册，如未注册则创建新用户记录。用户密码采用BCrypt算法加密存储，保证密码安全。注册成功后，系统为用户分配默认角色和权限。\n\n用户登录功能支持多种登录方式。账号密码登录时，系统根据用户名或手机号查询用户信息，验证密码是否正确。密码验证通过后，系统生成JWT令牌返回给客户端，令牌中包含用户ID、角色等信息。客户端将令牌保存在本地，后续请求在Header中携带令牌。系统也支持手机验证码登录，用户输入手机号获取验证码，输入正确的验证码后即可登录。验证码具有时效性，一般5分钟内有效。\n\n个人信息管理功能允许用户查看和修改个人资料。用户可以修改昵称、头像、性别、生日等基本信息。用户可以管理收货地址，包括添加、编辑、删除地址，设置默认地址等。地址信息包括收货人、联系电话、省市区、详细地址等字段。系统对地址信息进行必填校验，确保数据的完整性。\n\n权限管理基于RBAC模型设计。系统定义了管理员和普通用户两种角色，不同角色拥有不同的权限。管理员可以访问后台管理功能，进行商品管理、订单管理等操作。普通用户只能访问前台功能，进行购物和订单查询。系统通过网关进行权限校验，解析JWT令牌获取用户角色，根据角色判断是否有权访问接口。\n\n用户服务提供的主要接口包括：用户注册、用户登录、获取用户信息、修改用户信息、地址管理、权限验证等。这些接口为其他服务提供了用户相关的基础能力。"
}