{
  "id": "6.4",
  "title": "可靠性测试",
  "word_limit": 500,
  "text": "placeholder",
  "_note": "二级章节，无子节点，需要text",
  "content": "可靠性测试通过故障注入和异常场景模拟，验证系统的容错能力和高可用性，确保系统在故障情况下能够正常运行或优雅降级。\n\n服务故障测试模拟微服务实例故障的场景。测试方法：启动商品服务的两个实例，通过Nacos查看服务列表包含两个实例。强制停止其中一个实例，模拟服务宕机。Nacos健康检查在15秒内检测到实例不可用，将其从服务列表中剔除。此时调用商品服务，请求自动路由到健康的实例，服务正常响应，用户无感知。重新启动停止的实例，Nacos自动发现新实例并加入服务列表，负载均衡恢复到两个实例。测试验证了Nacos服务注册与发现的高可用性，单个服务实例故障不影响整体服务可用性。\n\n网络故障测试模拟服务间网络异常。使用工具模拟网络延迟和丢包，订单服务调用商品服务时网络超时。Sentinel熔断器检测到超时率超过阈值，自动熔断商品服务的调用，快速失败并返回降级响应。订单创建失败，提示用户稍后重试，而不是长时间等待超时。熔断时间窗口结束后，Sentinel尝试恢复调用，如果网络恢复，熔断器关闭，服务调用恢复正常。测试验证了熔断降级机制的有效性，避免了故障扩散和级联失败。\n\n数据库故障测试模拟数据库连接异常。停止MySQL服务，模拟数据库宕机。系统尝试连接数据库失败，抛出数据库连接异常。但已缓存的数据仍可从Redis读取，商品查询等功能部分可用。系统监控检测到数据库连接失败，触发告警通知运维人员。数据库恢复后，连接池重新建立连接，服务恢复正常。主从复制场景下，主库故障时，可以将从库提升为主库，保证数据库的高可用性。测试验证了系统对数据库故障的处理能力。\n\nRedis故障测试模拟缓存服务不可用。停止Redis服务，系统访问Redis失败，捕获异常并记录日志。购物车服务降级为直接访问MySQL数据库，功能可用但性能下降。商品查询降级为直接查询数据库，跳过缓存。推荐服务降级返回默认推荐列表。系统核心功能在缓存故障时仍然可用，体现了服务降级的设计思想。Redis恢复后，系统重新连接Redis，缓存功能恢复，性能提升。\n\n消息队列故障测试模拟RabbitMQ不可用。消息发送失败时，系统捕获异常，记录失败日志，将消息持久化到数据库。定时任务定期扫描失败消息，重新发送到恢复的消息队列。这种设计保证了重要消息不丢失，如订单支付成功通知，即使消息队列故障，用户也能最终收到通知。\n\n长时间运行测试验证系统的稳定性。持续运行系统72小时，模拟日常业务操作，监控系统的内存使用、CPU使用、线程数等指标。测试期间系统运行稳定，没有出现内存泄漏、线程堆积等问题。JVM垃圾回收正常，Full GC次数少，停顿时间短。服务响应时间保持稳定，没有性能衰减。\n\n可靠性测试结果表明，系统具备良好的容错能力，单点故障不影响系统整体可用性，故障恢复机制有效，系统可用性达到设计要求的99.9%以上，满足电商业务对高可用性的要求。"
}