{
  "id": "5.2.5",
  "title": "首页推荐模块实现",
  "word_limit": 500,
  "text": "placeholder",
  "imagePath": "${impl}/impl-recommend.png",
  "_note": "三级章节，必须有text，包含实现截图",
  "content": "首页推荐模块基于多种推荐算法，为用户提供个性化的商品推荐服务。模块实现效果如图5-5所示。\n\n数据库设计方面，用户行为表user_behavior记录用户的浏览、收藏、购买行为，包含id、user_id、product_id、behavior_type（行为类型：1浏览 2收藏 3购买）、create_time等字段。商品评分表product_score存储商品的综合评分，包含product_id、sales_score（销量分）、view_score（浏览量分）、total_score（总分）等字段。推荐结果缓存表recommend_cache存储预计算的推荐结果。\n\nService层实现推荐算法。热门商品推荐基于商品的多维度指标计算热度分数。从数据库查询所有上架商品的销量、浏览量、收藏量数据，使用加权公式计算热度分数：总分 = 销量 × 0.5 + 浏览量 × 0.3 + 收藏量 × 0.2。分数归一化处理，按总分降序排序，取前50个商品作为热门推荐。推荐结果缓存在Redis中，Key为recommend:hot，Value为商品ID列表，设置1小时过期时间。定时任务每小时重新计算热门商品，更新缓存。\n\n新品推荐查询最近7天内上架的商品，按上架时间倒序排序，取前30个商品。新品列表同样缓存在Redis中，Key为recommend:new，定时更新。对于新品中销量较好的商品给予更高权重，提升推荐质量。\n\n个性化推荐采用基于内容的推荐算法。根据用户浏览和购买历史，提取用户感兴趣的商品分类和属性。计算商品相似度，使用余弦相似度算法，商品特征向量包括分类、价格区间、品牌等。找出与用户历史商品相似度高的其他商品进行推荐。个性化推荐结果缓存Key为recommend:user:userId，设置24小时过期时间。对于新用户没有历史行为数据，降级为展示热门商品。\n\n协同过滤推荐基于用户行为数据挖掘用户之间的相似性。计算用户相似度，找出与目标用户兴趣相似的其他用户（相似用户）。推荐相似用户购买过但目标用户未购买的商品。由于计算量较大，协同过滤推荐使用离线计算方式，定时任务在凌晨执行，将推荐结果预先计算好存储在数据库和Redis中，接口查询时直接返回预计算结果。\n\n分类推荐按商品分类组织推荐内容。查询各个一级分类下销量最高的商品，每个分类展示6个商品。分类推荐适合展示商品种类的丰富性，帮助用户发现不同类别的商品。分类推荐结果缓存在Redis中，Key为recommend:category，定时更新。\n\n推荐服务聚合多种推荐算法的结果。首页推荐接口根据用户登录状态返回不同内容。已登录用户优先展示个性化推荐，然后展示热门推荐和新品推荐。未登录用户展示热门推荐、新品推荐和分类推荐。推荐列表采用轮播图和瀑布流布局，提升视觉效果。\n\nController层提供推荐接口。首页推荐接口GET /api/recommend/home返回首页推荐数据，包括轮播图、热门商品、新品推荐、分类推荐等多个板块。个性化推荐接口GET /api/recommend/personal需要用户登录，返回个性化推荐结果。相似商品推荐接口GET /api/recommend/similar/{productId}返回与指定商品相似的其他商品，用于商品详情页的关联推荐。推荐模块通过多种算法组合，为用户提供了丰富的商品推荐，提升了用户购物体验和商品转化率。"
}