{
  "id": "5.2.2",
  "title": "商品管理模块实现",
  "word_limit": 600,
  "text": "placeholder",
  "imagePath": "${impl}/impl-goods.png",
  "_note": "三级章节，必须有text，包含实现截图",
  "content": "商品管理模块实现了商品信息的全生命周期管理，包括商品的增删改查、分类管理、库存管理等功能。模块实现效果如图5-2所示。\n\n数据库设计包含商品表、商品分类表和库存表。商品表存储商品基本信息、价格、库存、图片地址、销售状态等字段。商品分类表采用树形结构，通过父节点关联构建分类层次。库存表单独维护可用库存和锁定库存，支持库存的预扣减和释放机制。\n\n实体类设计使用对象映射工具。商品实体类映射商品表，字段与数据库对应。分类实体类通过递归构建分类树。数据传输对象用于接收前端提交的商品信息，视图对象用于返回包含关联数据的商品信息。\n\n数据访问层使用ORM框架实现。商品数据访问接口继承基础接口，提供标准的增删改查方法。自定义方法通过映射文件编写复杂查询。商品列表查询支持多条件筛选，使用动态SQL根据参数拼接查询条件。分页查询自动完成分页处理。库存扣减使用乐观锁机制，在更新时检查库存充足条件，防止库存超卖。\n\n业务逻辑层实现核心功能。商品添加方法验证必填字段，上传商品图片获取图片地址存入数据库。商品初始状态设置为下架，需审核后上架。商品修改方法验证商品所属权限，更新商品信息和图片。商品删除采用逻辑删除，保留历史记录。商品查询方法根据查询条件获取分页数据，转换为视图对象填充关联信息返回。\n\n缓存优化是商品模块的重点。商品详情查询采用缓存三重防护策略。查询流程先查缓存，命中直接返回；未命中查数据库，不存在则缓存空对象防止缓存穿透；存在则写入缓存返回。热点商品使用互斥锁防止缓存击穿，只允许一个请求查库并更新缓存。缓存雪崩通过设置随机过期时间避免。商品列表查询也使用缓存，将查询条件作为缓存键实现细粒度缓存。\n\n分类管理实现包括分类树构建和分类维护。查询分类树方法从数据库查询所有分类，在内存中使用递归算法构建树形结构。添加分类时验证父分类存在性，计算分类层级。修改和删除分类时检查是否有子分类或关联商品，有则不允许删除。\n\nAPI接口层提供完整的RESTful服务。管理员接口需要管理员权限控制，用户接口提供商品查询和搜索功能。商品搜索接口支持关键词模糊匹配，在商品名称和描述中搜索，结果按相关度和销量排序。商品管理模块的实现支撑了电商平台的商品展示和管理需求。"
}
