@startuml
!define RECTANGLE class
!theme plain

entity User {
  * id : Long <<PK>>
  --
  username : String
  password : String
  real_name : String
  phone : String
  email : String
  role_id : Long
  status : Integer
}

entity Venue {
  * id : Long <<PK>>
  --
  name : String
  type : String
  capacity : Integer
  price : BigDecimal
  status : Integer
}

entity Reservation {
  * id : Long <<PK>>
  --
  user_id : Long <<FK>>
  course_id : Long <<FK>>
  venue_id : Long <<FK>>
  membership_card_id : Long <<FK>>
  start_time : LocalDateTime
  end_time : LocalDateTime
  status : Integer
}

entity Course {
  * id : Long <<PK>>
  --
  name : String
  coach_id : Long <<FK>>
  venue_id : Long <<FK>>
  start_time : LocalDateTime
  end_time : LocalDateTime
  capacity : Integer
  price : BigDecimal
}

entity MembershipCard {
  * id : Long <<PK>>
  --
  user_id : Long <<FK>>
  type : Integer
  name : String
  total_times : Integer
  remaining_times : Integer
  start_date : LocalDate
  end_date : LocalDate
}

entity CheckIn {
  * id : Long <<PK>>
  --
  reservation_id : Long <<FK>>
  user_id : Long <<FK>>
  venue_id : Long <<FK>>
  course_id : Long <<FK>>
  check_in_time : LocalDateTime
  status : Integer
}

entity QRCode {
  * id : Long <<PK>>
  --
  qr_id : String
  venue_id : Long <<FK>>
  qr_content : String
  valid_start_time : LocalDateTime
  valid_end_time : LocalDateTime
  status : Integer
}

' 关系定义
User ||--o{ Reservation : "1:N 用户发起预约"
User ||--o{ MembershipCard : "1:N 用户持有会员卡"
User ||--o{ CheckIn : "1:N 用户签到记录"
User ||--o{ Course : "1:N 教练授课"

Venue ||--o{ Reservation : "1:N 场地被预约"
Venue ||--o{ Course : "1:N 场地安排课程"
Venue ||--o{ CheckIn : "1:N 场地签到记录"
Venue ||--o{ QRCode : "1:N 场地二维码"

Reservation ||--o{ CheckIn : "1:N 预约对应签到"
Reservation }o--|| MembershipCard : "N:1 预约使用会员卡"

Course ||--o{ Reservation : "1:N 课程被预约"
Course ||--o{ CheckIn : "1:N 课程签到记录"

note top of User : 用户实体\n系统核心用户信息
note top of Venue : 场地实体\n健身房场地资源
note top of Reservation : 预约实体\n预约业务核心
note top of Course : 课程实体\n团体课程管理
note top of MembershipCard : 会员卡实体\n会员权益管理
note top of CheckIn : 签到实体\n考勤记录管理
note top of QRCode : 二维码实体\n移动端服务支持

@enduml