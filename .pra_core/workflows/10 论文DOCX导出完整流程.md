# ğŸ“„ è®ºæ–‡DOCXå¯¼å‡ºå®Œæ•´æµç¨‹

## âœ… çŠ¶æ€ï¼šå·²å®ç°

æœ¬å·¥ä½œæµå·²å®Œæ•´å®ç°ï¼ŒåŒ…å«ä»æ ¼å¼æ–‡æ¡£åˆ†æåˆ°å®Œæ•´è®ºæ–‡å¯¼å‡ºçš„å…¨æµç¨‹ï¼Œæ”¯æŒè‡ªåŠ¨å›¾è¡¨ç¼–å·ã€SVGè½¬æ¢ã€è¡¨æ ¼ç”Ÿæˆç­‰é«˜çº§åŠŸèƒ½ã€‚

**é€šç”¨æ€§è®¾è®¡**ï¼šæœ¬å·¥ä½œæµæ”¯æŒä¸åŒå­¦æ ¡çš„æ ¼å¼è¦æ±‚å’Œä¸åŒç±»å‹çš„è®ºæ–‡é¡¹ç›®ï¼Œé€šè¿‡é…ç½®æ–‡ä»¶å®ç°æ ¼å¼é€‚é…ã€‚

## ğŸ“Œ å˜é‡è¯´æ˜

æœ¬æ–‡æ¡£ä½¿ç”¨ä»¥ä¸‹å ä½ç¬¦ï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µæ›¿æ¢ï¼š

| å ä½ç¬¦ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|
| `<SCHOOL_NAME>` | å­¦æ ¡å…¨ç§° | ç‰æºªå¸ˆèŒƒå­¦é™¢ã€äº‘å—å¤§å­¦ |
| `<SCHOOL_ABBR>` | å­¦æ ¡ç®€ç§°ï¼ˆè‹±æ–‡ï¼‰ | yxnu, ynu |
| `<PROJECT_NAME>` | é¡¹ç›®åç§° | é£Ÿå ‚è¯„ä»·ç³»ç»Ÿã€å›¾ä¹¦ç®¡ç†ç³»ç»Ÿ |
| `<PROJECT_DIR>` | é¡¹ç›®ç›®å½•å | canteen-rating, library-mgmt |
| `<ENTITY_NAME>` | å®ä½“åç§° | User, Product, Order |
| `<TABLE_NAME>` | è¡¨å | users, products, orders |

---

## ğŸ¯ ç›®æ ‡

ä»å­¦æ ¡æä¾›çš„è®ºæ–‡æ ¼å¼è¦æ±‚æ–‡æ¡£å¼€å§‹ï¼Œé€šè¿‡AIè§†è§‰åˆ†ææå–æ ¼å¼è§„èŒƒï¼Œç”Ÿæˆæ ‡å‡†åŒ–é…ç½®ï¼Œæœ€ç»ˆå¯¼å‡ºåŒ…å«å®Œæ•´å›¾è¡¨çš„è§„èŒƒWordæ–‡æ¡£ã€‚

**æ ¸å¿ƒç‰¹æ€§**:
- ğŸ” AIè§†è§‰åˆ†ææ ¼å¼æ–‡æ¡£ï¼ˆå¤šæ¨¡æ€èƒ½åŠ›ï¼‰
- ğŸ“ è‡ªåŠ¨ç”Ÿæˆæ ·å¼é…ç½®JSON
- ğŸ–¼ï¸ æ”¯æŒPNGå’ŒSVGå›¾ç‰‡ï¼ˆSVGè‡ªåŠ¨è½¬æ¢ï¼‰
- ğŸ“Š è¡¨æ ¼ä»JSONç”Ÿæˆï¼ˆä¸‰çº¿è¡¨æ ¼å¼ï¼‰
- ğŸ”¢ å›¾è¡¨è‡ªåŠ¨ç¼–å·ï¼ˆç« èŠ‚å·-åºå·ï¼‰
- ğŸ¨ å®Œå…¨ç¬¦åˆå­¦æ ¡æ ¼å¼è¦æ±‚
- ğŸ”„ æ”¯æŒå¤šå­¦æ ¡æ ¼å¼é…ç½®

## ğŸ“‹ é€‚ç”¨åœºæ™¯

- éœ€è¦æŒ‰å­¦æ ¡æ ¼å¼å¯¼å‡ºæ¯•ä¸šè®ºæ–‡
- è®ºæ–‡åŒ…å«å¤§é‡å›¾è¡¨éœ€è¦è‡ªåŠ¨ç¼–å·
- éœ€è¦å¤„ç†SVGæ ¼å¼çš„ERå›¾ã€UMLå›¾ç­‰
- éœ€è¦ä»JSONæ•°æ®ç”Ÿæˆè§„èŒƒè¡¨æ ¼
- éœ€è¦å¤ç”¨ä¸åŒå­¦æ ¡çš„æ ¼å¼é…ç½®
- éœ€è¦æ”¯æŒå¤šä¸ªè®ºæ–‡é¡¹ç›®çš„æ ¼å¼ç»Ÿä¸€

## ğŸ”„ å®Œæ•´æ‰§è¡Œæµç¨‹

### Phase 1: æ ¼å¼æ–‡æ¡£è½¬æˆªå›¾

**å·¥å…·**: `tools/word-to-screenshots.py`

**åŠŸèƒ½**:
- æ”¯æŒ .doc å’Œ .docx æ ¼å¼
- ä½¿ç”¨ LibreOffice è½¬æ¢ä¸ºPDF
- ä½¿ç”¨ Poppler (pdftoppm) è½¬æ¢ä¸ºPNG
- å¯é…ç½®DPIï¼ˆå»ºè®®300 DPIï¼‰

**æ‰§è¡Œå‘½ä»¤**:
```bash
python3 tools/word-to-screenshots.py \
  "tools/format-screenshots/<SCHOOL_NAME>æ¯•ä¸šè®ºæ–‡æ ¼å¼è¦æ±‚.doc" \
  "tools/format-screenshots" \
  300
```

**è¾“å‡º**:
- æˆªå›¾ç›®å½•: `tools/format-screenshots/<SCHOOL_NAME>æ¯•ä¸šè®ºæ–‡æ ¼å¼è¦æ±‚_screenshots/`
- æ–‡ä»¶æ ¼å¼: `page-001.png`, `page-002.png`, ...
- åˆ†è¾¨ç‡: 300 DPIï¼ˆé€‚åˆAIè¯†åˆ«ï¼‰

**ä¾èµ–**:
```bash
# macOSå®‰è£…
brew install --cask libreoffice
brew install poppler
```

---

### Phase 2: AIè§†è§‰åˆ†ææ ¼å¼

**æ–¹æ³•**: ä½¿ç”¨Claudeå¤šæ¨¡æ€èƒ½åŠ›åˆ†ææˆªå›¾

**åˆ†æç»´åº¦**:
1. **é¡µé¢è®¾ç½®**
   - çº¸å¼ å¤§å°ï¼ˆA4: 210mm Ã— 297mmï¼‰
   - é¡µè¾¹è·ï¼ˆä¸Š/ä¸‹/å·¦/å³ï¼‰
   - é¡µçœ‰é¡µè„šè·ç¦»

2. **å­—ä½“è§„èŒƒ**
   - ä¸­æ–‡å­—ä½“ï¼ˆå®‹ä½“ã€é»‘ä½“ã€åæ–‡è¡Œæ¥·ï¼‰
   - è‹±æ–‡å­—ä½“ï¼ˆTimes New Romanï¼‰
   - å­—å·å¯¹ç…§è¡¨ï¼ˆä¸‰å·16ptã€å°ä¸‰15ptã€å°å››12ptã€äº”å·10.5ptï¼‰

3. **æ ·å¼å®šä¹‰**
   - æ­£æ–‡æ ·å¼ï¼ˆå­—ä½“ã€å­—å·ã€è¡Œè·ã€å¯¹é½ã€ç¼©è¿›ï¼‰
   - å„çº§æ ‡é¢˜æ ·å¼ï¼ˆä¸€çº§ã€äºŒçº§ã€ä¸‰çº§ï¼‰
   - æ‘˜è¦å’Œå…³é”®è¯æ ·å¼
   - å›¾è¡¨æ ‡æ³¨æ ·å¼

4. **ç‰¹æ®Šè§„åˆ™**
   - é¦–è¡Œç¼©è¿›ï¼ˆæ˜¯å¦éœ€è¦ï¼‰
   - åŒé¢æ‰“å°è¦æ±‚
   - é¡µç æ ¼å¼ï¼ˆæ‘˜è¦ç½—é©¬æ•°å­—ï¼Œæ­£æ–‡é˜¿æ‹‰ä¼¯æ•°å­—ï¼‰
   - å›¾è¡¨ç¼–å·æ ¼å¼ï¼ˆå›¾ ç« å·-åºå·  æ ‡é¢˜ï¼‰

**æ‰§è¡Œæ­¥éª¤**:
1. åœ¨Claude Codeä¸­è¯»å–æˆªå›¾æ–‡ä»¶
2. ä½¿ç”¨Readå·¥å…·æ‰¹é‡æŸ¥çœ‹æˆªå›¾ï¼ˆæ”¯æŒå›¾ç‰‡æŸ¥çœ‹ï¼‰
3. AIåˆ†ææ¯é¡µå†…å®¹ï¼Œæå–æ ¼å¼è¦æ±‚
4. ç”Ÿæˆæ ¼å¼åˆ†ææŠ¥å‘ŠMarkdown

**è¾“å‡ºæ–‡ä»¶**: `thesis-formats/<SCHOOL_NAME>-æ ¼å¼åˆ†æ.md`

**ç¤ºä¾‹å†…å®¹**:
```markdown
## ğŸ“‹ é¡µé¢è®¾ç½®
- **çº¸å¼ **: A4 (210mm Ã— 297mm)
- **è¾¹è·**: ä¸Š2.5cm, ä¸‹2.0cm, å·¦2.5cm, å³2.0cm
- **é¡µçœ‰è·ç¦»**: 1.75cm
- **é¡µè„šè·ç¦»**: 1.0cm

## ğŸ”¤ å­—ä½“å’Œå­—å·
| å­—å·åç§° | ç£…å€¼(pt) | ä½¿ç”¨åœºæ™¯ |
|---------|---------|---------|
| ä¸‰å· | 16 | ç« æ ‡é¢˜ |
| å°ä¸‰å· | 15 | èŠ‚æ ‡é¢˜ |
| å°å››å· | 12 | æ­£æ–‡ |

## âœ… æ ·å¼é…ç½®éªŒè¯
å½“å‰é…ç½®åŸºæœ¬ç¬¦åˆæ ¼å¼è¦æ±‚ã€‚
```

---

### Phase 3: ç”Ÿæˆæ ·å¼é…ç½®æ–‡ä»¶

**è¾“å‡ºæ–‡ä»¶**: `templates/docx-styles-<SCHOOL_ABBR>.json`

**å‘½åè§„èŒƒ**:
- æ–‡ä»¶åæ ¼å¼ï¼š`docx-styles-<å­¦æ ¡ç®€ç§°>.json`
- ç¤ºä¾‹ï¼š`docx-styles-yxnu.json`ï¼ˆç‰æºªå¸ˆèŒƒå­¦é™¢ï¼‰
- ç¤ºä¾‹ï¼š`docx-styles-ynu.json`ï¼ˆäº‘å—å¤§å­¦ï¼‰

**é…ç½®ç»“æ„**:
```json
{
  "version": "1.0",
  "school": "<SCHOOL_NAME>",
  "presets": {
    "<school_abbr>_thesis": {
      "page": {
        "size": "A4",
        "margin": {
          "top": 1800,     // twips (1cm â‰ˆ 567 twips)
          "bottom": 1440,
          "left": 1800,
          "right": 1440
        },
        "header_distance": 1260,
        "footer_distance": 720
      }
    }
  },
  "styles": {
    "chapter_title": {
      "font": {
        "name": "Times New Roman",
        "name_cn": "å®‹ä½“",
        "size": 32,        // åŠç£…å€¼ (32 = 16pt)
        "bold": true
      },
      "alignment": "left",
      "spacing": {
        "before": 240,     // twips
        "after": 120,
        "line": 1.5        // å€æ•°
      },
      "headingLevel": 1
    }
    // ... å…±22ä¸ªæ ·å¼å®šä¹‰
  }
}
```

**æ ·å¼æ¸…å•** (22ä¸ª):
- default, title, chapter_title, section_title, subsection_title
- body_text, abstract_title, abstract_text, keywords
- toc_title, toc_1, toc_2
- figure_caption, table_caption, table_header, table_cell
- reference_title, reference_item
- appendix_title, code_block, quote, footnote

---

### Phase 4: å¢å¼ºå¯¼å‡ºå·¥å…·å®ç°

**å·¥å…·**: `tools/thesis-to-docx-enhanced.py`

**æ ¸å¿ƒåŠŸèƒ½**:

#### 4.1 è·¯å¾„å˜é‡è§£æå™¨ (PathResolver)
```python
# æ”¯æŒçš„è·¯å¾„å˜é‡
${er}     â†’ paper/assets/diagrams/er
${uml}    â†’ paper/assets/diagrams/uml
${dfd}    â†’ paper/assets/diagrams/dfd
${flow}   â†’ paper/assets/diagrams/flow
${tables} â†’ paper/assets/tables

# ä½¿ç”¨ç¤ºä¾‹ï¼ˆåœ¨ç« èŠ‚JSONä¸­ï¼‰
{
  "imagePath": "${er}/<entity-name>.svg",
  "tablePath": "${tables}/<table-name>.json"
}
```

#### 4.2 æ ·å¼ç®¡ç†å™¨ (StyleManager)
- åŠ è½½æ ·å¼é…ç½®JSON
- åº”ç”¨å­—ä½“ã€å­—å·ã€è¡Œè·ã€å¯¹é½ã€ç¼©è¿›
- å¤„ç†ä¸­è¥¿æ–‡æ··æ’ï¼ˆä¸­æ–‡å®‹ä½“ã€è‹±æ–‡Times New Romanï¼‰
- æ”¯æŒæ ‡é¢˜çº§åˆ«é…ç½®ï¼ˆç”ŸæˆWordç›®å½•ï¼‰

#### 4.3 è®ºæ–‡æ„å»ºå™¨ (ThesisBuilder)
**ä¸»è¦æ–¹æ³•**:

1. **`insert_image(image_path, caption, width_cm)`**
   - æ”¯æŒPNGç›´æ¥æ’å…¥
   - SVGè‡ªåŠ¨è½¬PNGï¼ˆä½¿ç”¨rsvg-convert, 300 DPIï¼‰
   - å›¾ç‰‡å±…ä¸­å¯¹é½
   - æ·»åŠ å›¾é¢˜ï¼ˆä½¿ç”¨figure_captionæ ·å¼ï¼‰

2. **`insert_table(table_path, caption)`**
   - ä»JSONè¯»å–è¡¨æ ¼æ•°æ®
   - ç”Ÿæˆä¸‰çº¿è¡¨æ ¼å¼
   - è¡¨å¤´åŠ ç²—å±…ä¸­
   - æ·»åŠ è¡¨é¢˜ï¼ˆä½¿ç”¨table_captionæ ·å¼ï¼‰

3. **`get_next_figure_number(chapter_num)`**
   - æŒ‰ç« èŠ‚è‡ªåŠ¨è®¡æ•°
   - è¿”å›ç¼–å·ï¼š`4-1`, `4-2`, `4-3`, ...

4. **`get_next_table_number(chapter_num)`**
   - æŒ‰ç« èŠ‚è‡ªåŠ¨è®¡æ•°
   - è¿”å›ç¼–å·ï¼š`4-1`, `4-2`, `4-3`, ...

5. **`add_chapter_content(chapter_data)`**
   - æ·»åŠ ç« èŠ‚æ ‡é¢˜å’Œå†…å®¹
   - å¤„ç†itemsæ•°ç»„ï¼ˆå­é¡¹ï¼‰
   - è‡ªåŠ¨æ’å…¥å›¾è¡¨å¹¶ç¼–å·
   - æ”¯æŒæ‰€æœ‰å±‚çº§æ ‡é¢˜ï¼ˆä¸€çº§ã€äºŒçº§ã€ä¸‰çº§ï¼‰

6. **`get_title_level_and_style(chapter_id)`**
   - æ ¹æ®ç« èŠ‚IDè‡ªåŠ¨åˆ¤æ–­å±‚çº§
   - è¿”å›å¯¹åº”çš„æ ·å¼åç§°

#### 4.4 å›¾è¡¨è‡ªåŠ¨ç¼–å·æœºåˆ¶
```python
# è®¡æ•°å™¨ç»“æ„
figure_counters = {
  "3": 2,  # ç¬¬3ç« æœ‰2ä¸ªå›¾
  "4": 8,  # ç¬¬4ç« æœ‰8ä¸ªå›¾
  "5": 6   # ç¬¬5ç« æœ‰6ä¸ªå›¾
}

# ç¼–å·æ ¼å¼
caption = f"å›¾ {chapter_num}-{counter}  {title}"
# è¾“å‡º: "å›¾ 4-1  ç³»ç»Ÿæ¶æ„å›¾"
#       ç¼–å·åç©ºä¸¤ä¸ªå­—ï¼ˆç¬¦åˆæ ¼å¼è¦æ±‚ï¼‰
```

#### 4.5 SVGè½¬æ¢å¤„ç†
```python
# æ£€æµ‹SVGæ–‡ä»¶
if image_path.suffix.lower() == '.svg':
    # è½¬æ¢ä¸ºä¸´æ—¶PNG
    subprocess.run([
        'rsvg-convert',
        '-d', '300',  # DPI
        '-p', '300',
        '-o', temp_png_path,
        str(image_path)
    ])
    # æ’å…¥PNG
    # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
```

**ä¾èµ–å®‰è£…**:
```bash
brew install librsvg
pip3 install python-docx
```

---

### Phase 5: æ‰§è¡Œå¯¼å‡º

**åŸºç¡€å‘½ä»¤**:
```bash
python3 tools/thesis-to-docx-enhanced.py
```

**å¯é€‰å‚æ•°**:
```bash
python3 tools/thesis-to-docx-enhanced.py \
  --style templates/docx-styles-<SCHOOL_ABBR>.json \
  --output paper/<PROJECT_NAME>è®ºæ–‡-å®Œæ•´ç‰ˆ.docx \
  --project /path/to/project
```

**æ‰§è¡Œè¿‡ç¨‹ç¤ºä¾‹**:
```
ğŸ“š è®ºæ–‡å¯¼å‡ºå·¥å…·ï¼ˆå¢å¼ºç‰ˆï¼‰
============================================================
ğŸ“‚ é¡¹ç›®ç›®å½•: /path/to/<PROJECT_DIR>
ğŸ¨ æ ·å¼é…ç½®: docx-styles-<SCHOOL_ABBR>.json
ğŸ“„ è¾“å‡ºæ–‡ä»¶: paper/<PROJECT_NAME>è®ºæ–‡-å®Œæ•´ç‰ˆ.docx

âš™ï¸  åŠ è½½æ ·å¼é…ç½®...
  âœ… å·²åŠ è½½ 22 ä¸ªæ ·å¼

ğŸ—ï¸  æ„å»ºè®ºæ–‡...
  âœ… å·²åŠ è½½å¤§çº²ï¼Œå…± N ä¸ªé¡¶å±‚ç« èŠ‚

âœï¸  ç”Ÿæˆç« èŠ‚å†…å®¹ï¼ˆåŒ…å«å›¾ç‰‡å’Œè¡¨æ ¼ï¼‰...
  âœ… 0.1 æ‘˜è¦
  âœ… 0.2 Abstract
  âœ… ç¬¬1ç«  ç»ªè®º (ä½¿ç”¨å¤§çº²æ ‡é¢˜)
  âœ… 1.1 ç ”ç©¶èƒŒæ™¯åŠæ„ä¹‰
  ...
  âœ… 4.1 ç³»ç»Ÿæ•´ä½“æ¶æ„è®¾è®¡ (ä½¿ç”¨å¤§çº²æ ‡é¢˜)
  âœ… 4.1.1 æ¶æ„é€‰æ‹©
    âœ… æ’å…¥å›¾ç‰‡: system-arch.png
  âœ… 4.2 æ•°æ®åº“è®¾è®¡ (ä½¿ç”¨å¤§çº²æ ‡é¢˜)
    ğŸ”„ è½¬æ¢SVG: entity-diagram.svg â†’ PNG
    âœ… æ’å…¥å›¾ç‰‡: entity-diagram.svg
    ...
  âœ… 4.2.2 é€»è¾‘ç»“æ„è®¾è®¡
    âœ… æ’å…¥è¡¨æ ¼: table-structure.json (Nè¡Œ Ã— Måˆ—)
    ...

ğŸ’¾ ä¿å­˜æ–‡æ¡£...

============================================================
âœ… è®ºæ–‡å¯¼å‡ºæˆåŠŸï¼
ğŸ“„ æ–‡ä»¶ä½ç½®: paper/<PROJECT_NAME>è®ºæ–‡-å®Œæ•´ç‰ˆ.docx
ğŸ“Š æ–‡ä»¶å¤§å°: XXX KB
```

---

## ğŸ“ è·¯å¾„çº¦å®š

```
<projectRoot>/
â”œâ”€â”€ tools/
â”‚   â”œâ”€â”€ word-to-screenshots.py          # Phase 1: æ–‡æ¡£è½¬æˆªå›¾
â”‚   â”œâ”€â”€ thesis-to-docx-enhanced.py      # Phase 4-5: å¢å¼ºå¯¼å‡ºå·¥å…·
â”‚   â””â”€â”€ format-screenshots/             # æˆªå›¾å­˜å‚¨ç›®å½•
â”‚       â””â”€â”€ <SCHOOL_NAME>_screenshots/
â”‚           â”œâ”€â”€ page-001.png
â”‚           â”œâ”€â”€ page-002.png
â”‚           â””â”€â”€ ...
â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ docx-styles-<SCHOOL_ABBR>.json  # Phase 3: æ ·å¼é…ç½®
â”‚   â””â”€â”€ ...                              # æ”¯æŒå¤šä¸ªå­¦æ ¡é…ç½®
â”œâ”€â”€ thesis-formats/
â”‚   â”œâ”€â”€ <SCHOOL_NAME>-æ ¼å¼åˆ†æ.md       # Phase 2: æ ¼å¼åˆ†ææŠ¥å‘Š
â”‚   â””â”€â”€ ...                              # æ”¯æŒå¤šä¸ªå­¦æ ¡æ ¼å¼
â”œâ”€â”€ paper/
â”‚   â”œâ”€â”€ outline.json                     # è®ºæ–‡å¤§çº²
â”‚   â”œâ”€â”€ chapters/                        # ç« èŠ‚å†…å®¹
â”‚   â”‚   â”œâ”€â”€ chapter.0.1.json            # æ‘˜è¦
â”‚   â”‚   â”œâ”€â”€ chapter.0.2.json            # Abstract
â”‚   â”‚   â””â”€â”€ ...                          # æ ¹æ®é¡¹ç›®è€Œå®š
â”‚   â”œâ”€â”€ assets/                          # å›¾è¡¨èµ„æº
â”‚   â”‚   â”œâ”€â”€ diagrams/
â”‚   â”‚   â”‚   â”œâ”€â”€ er/                     # ERå›¾ (SVG)
â”‚   â”‚   â”‚   â”œâ”€â”€ uml/                    # UMLå›¾ (PNG)
â”‚   â”‚   â”‚   â”œâ”€â”€ dfd/                    # æ•°æ®æµå›¾ (PNG)
â”‚   â”‚   â”‚   â””â”€â”€ flow/                   # æµç¨‹å›¾ (PNG)
â”‚   â”‚   â””â”€â”€ tables/                     # è¡¨æ ¼JSON
â”‚   â”‚       â”œâ”€â”€ <entity>-table.json
â”‚   â”‚       â””â”€â”€ ...
â”‚   â””â”€â”€ <PROJECT_NAME>è®ºæ–‡-å®Œæ•´ç‰ˆ.docx  # æœ€ç»ˆè¾“å‡º
```

---

## ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

### ç« èŠ‚JSONæ ¼å¼ç¤ºä¾‹

```json
{
  "id": "4.2.1",
  "title": "æ¦‚å¿µç»“æ„è®¾è®¡",
  "docx_type": "section_title",
  "docx_type_text": "body_text",
  "content": "æœ¬èŠ‚ä»‹ç»ç³»ç»Ÿçš„æ¦‚å¿µç»“æ„è®¾è®¡...",
  "keywords": "å…³é”®è¯1ï¼›å…³é”®è¯2ï¼›å…³é”®è¯3",
  "items": [
    {
      "title": "<å®ä½“åç§°>ï¼ˆEntityï¼‰",
      "text": "å®ä½“æè¿°ä¿¡æ¯...",
      "imagePath": "${er}/<entity-name>.svg",
      "tablePath": "${tables}/<entity-name>.json"
    }
  ],
  "imagePath": "${er}/er-overall.png"
}
```

### è¡¨æ ¼JSONæ ¼å¼ç¤ºä¾‹

```json
{
  "title": "<è¡¨å>ç»“æ„",
  "columns": [
    ["å­—æ®µå", "æ•°æ®ç±»å‹", "é•¿åº¦", "çº¦æŸ", "è¯´æ˜"],
    ["id", "bigint", "20", "PK", "ä¸»é”®ID"],
    ["name", "varchar", "50", "NOT NULL", "åç§°"],
    ["status", "tinyint", "1", "NOT NULL", "çŠ¶æ€"]
  ]
}
```

### æ ·å¼åº”ç”¨ç¤ºä¾‹

```python
# åº”ç”¨ç« æ ‡é¢˜æ ·å¼
p = self.doc.add_paragraph("ç¬¬4ç«  ç³»ç»Ÿè®¾è®¡")
self.style_manager.apply_style_to_paragraph(p, 'chapter_title')

# ç»“æœ:
# - å­—ä½“: å®‹ä½“/Times New Roman
# - å­—å·: 16pt (ä¸‰å·)
# - åŠ ç²—: True
# - å¯¹é½: å·¦å¯¹é½
# - æ®µå‰: 12pt
# - æ®µå: 6pt
# - å¤§çº²çº§åˆ«: 1ï¼ˆå¯ç”Ÿæˆç›®å½•ï¼‰
```

---

## ğŸ“Š åŠŸèƒ½ç‰¹æ€§

### è‡ªåŠ¨åŠŸèƒ½
- âœ… å›¾è¡¨è‡ªåŠ¨ç¼–å·ï¼ˆæŒ‰ç« èŠ‚ï¼‰
- âœ… SVGè‡ªåŠ¨è½¬PNGï¼ˆ300 DPIï¼‰
- âœ… è¡¨æ ¼è‡ªåŠ¨ç”Ÿæˆï¼ˆä»JSONï¼‰
- âœ… æ‰€æœ‰å±‚çº§æ ‡é¢˜è‡ªåŠ¨æ˜¾ç¤º
- âœ… å¤§çº²çº§åˆ«è‡ªåŠ¨è®¾ç½®
- âœ… å…³é”®è¯è‡ªåŠ¨å¤„ç†

### æ ¼å¼ç¬¦åˆåº¦
- âœ… é¡µé¢è®¾ç½®ï¼šæ ¹æ®é…ç½®è‡ªåŠ¨åº”ç”¨
- âœ… å­—ä½“å­—å·ï¼šå®Œå…¨ç¬¦åˆå­¦æ ¡è¦æ±‚
- âœ… è¡Œè·å¯¹é½ï¼šæŒ‰é…ç½®åº”ç”¨
- âœ… é¦–è¡Œç¼©è¿›ï¼šæŒ‰é…ç½®åº”ç”¨
- âœ… å›¾è¡¨ç¼–å·ï¼šæ ¼å¼æ­£ç¡®ï¼ˆç« å·-åºå·  æ ‡é¢˜ï¼‰

### å¤šå­¦æ ¡æ”¯æŒ
- âœ… é…ç½®æ–‡ä»¶é©±åŠ¨
- âœ… ç‹¬ç«‹æ ¼å¼é…ç½®
- âœ… å¿«é€Ÿåˆ‡æ¢å­¦æ ¡æ ¼å¼
- âœ… æ”¯æŒæ ¼å¼å¯¹æ¯”

---

## ğŸ”— å·¥ä½œæµä¾èµ–

### å‰ç½®å·¥ä½œæµ
- **Workflow 04**: å¤§çº²ç¡®è®¤ä¸ç”Ÿæˆ â†’ ç”Ÿæˆ outline.json
- **Workflow 07**: æ™ºèƒ½å†…å®¹ç”Ÿæˆ â†’ ç”Ÿæˆç« èŠ‚JSON
- **Workflow 03**: å•ä½“ERå›¾æ‰¹é‡ç”Ÿæˆ â†’ ç”Ÿæˆ ERå›¾SVG
- **Workflow 09**: UMLå›¾è¡¨ç”Ÿæˆ â†’ ç”Ÿæˆæ•°æ®æµå›¾ã€æµç¨‹å›¾

### åç»­æ“ä½œ
- åœ¨Wordä¸­æ‰“å¼€æ–‡æ¡£
- æ›´æ–°ç›®å½•ï¼ˆå³é”®â†’æ›´æ–°åŸŸï¼‰
- æ£€æŸ¥å›¾è¡¨ä½ç½®å’Œå¤§å°
- æœ€ç»ˆæ£€æŸ¥æ ¼å¼

---

## ğŸ’¡ ä½¿ç”¨æŠ€å·§

### 1. æ‰¹é‡è½¬æ¢SVGä¸ºPNGï¼ˆå¯é€‰ï¼‰
å¦‚æœå¸Œæœ›é¢„å…ˆè½¬æ¢SVGï¼Œå¯ä»¥æ‰¹é‡å¤„ç†ï¼š
```bash
for svg in paper/assets/diagrams/er/*.svg; do
  png="${svg%.svg}.png"
  rsvg-convert -d 300 -p 300 -o "$png" "$svg"
done
```

### 2. éªŒè¯æ ·å¼é…ç½®
```python
import json

with open('templates/docx-styles-<SCHOOL_ABBR>.json') as f:
    config = json.load(f)

# æ£€æŸ¥æ ·å¼æ•°é‡
print(f"æ ·å¼æ•°é‡: {len(config['styles'])}")

# æ£€æŸ¥é¡µè¾¹è·
preset_name = list(config['presets'].keys())[0]
margins = config['presets'][preset_name]['page']['margin']
print(f"ä¸Šè¾¹è·: {margins['top']/567:.2f}cm")
```

### 3. è°ƒè¯•å•ä¸ªç« èŠ‚
ä¿®æ”¹å¯¼å‡ºå·¥å…·ï¼Œåªå¤„ç†ç‰¹å®šç« èŠ‚è¿›è¡Œè°ƒè¯•ï¼š
```python
# åœ¨ build_from_outline æ–¹æ³•ä¸­
if node_id != "4.2.1":  # åªå¯¼å‡º4.2.1ç« èŠ‚
    continue
```

### 4. è‡ªå®šä¹‰å›¾è¡¨å®½åº¦
åœ¨ä»£ç ä¸­è°ƒæ•´é»˜è®¤å®½åº¦ï¼š
```python
# ä¿®æ”¹ insert_image æ–¹æ³•
def insert_image(self, image_path, caption=None, width_cm=12):  # æ”¹ä¸º12cm
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. LibreOfficeå¿…é¡»å®‰è£…
word-to-screenshots.py ä¾èµ– LibreOffice çš„ soffice å‘½ä»¤ï¼š
```bash
# éªŒè¯å®‰è£…
which soffice
# æˆ–
/Applications/LibreOffice.app/Contents/MacOS/soffice --version
```

### 2. SVGè½¬æ¢å·¥å…·
å¿…é¡»å®‰è£… rsvg-convertï¼Œå¦åˆ™SVGå›¾ç‰‡ä¼šè¢«è·³è¿‡ï¼š
```bash
# éªŒè¯å®‰è£…
which rsvg-convert

# æµ‹è¯•è½¬æ¢
rsvg-convert -d 300 -p 300 -o test.png input.svg
```

### 3. å›¾è¡¨ç¼–å·é‡ç½®
æ¯æ¬¡è¿è¡Œå¯¼å‡ºå·¥å…·æ—¶ï¼Œå›¾è¡¨ç¼–å·ä»1å¼€å§‹ã€‚å¦‚æœéœ€è¦è·¨æ–‡æ¡£ä¿æŒç¼–å·ï¼Œéœ€è¦ä¿®æ”¹ä»£ç ã€‚

### 4. è¡¨æ ¼æ ·å¼é™åˆ¶
python-docx å¯¹è¡¨æ ¼æ ·å¼æ”¯æŒæœ‰é™ï¼Œå¤æ‚çš„ä¸‰çº¿è¡¨å¯èƒ½éœ€è¦åœ¨Wordä¸­æ‰‹åŠ¨è°ƒæ•´ã€‚

### 5. å¤§çº²çº§åˆ«
ç›®å‰æ ‡é¢˜çš„å¤§çº²çº§åˆ«é€šè¿‡ `headingLevel` é…ç½®ï¼ŒWordè‡ªåŠ¨ç”Ÿæˆç›®å½•ä¼šåŸºäºæ­¤ã€‚

---

## ğŸš€ æ‰©å±•åŠŸèƒ½

### æ”¯æŒæ–°å­¦æ ¡æ ¼å¼

**æ­¥éª¤**:
1. å‡†å¤‡è¯¥å­¦æ ¡çš„æ ¼å¼è¦æ±‚æ–‡æ¡£
2. æ‰§è¡ŒPhase 1-2è·å–æ ¼å¼æˆªå›¾å’Œåˆ†æ
3. åˆ›å»ºæ–°çš„æ ·å¼é…ç½®æ–‡ä»¶ï¼š
   ```bash
   cp templates/docx-styles-yxnu.json templates/docx-styles-<new-school>.json
   ```
4. æ ¹æ®åˆ†ææŠ¥å‘Šä¿®æ”¹é…ç½®æ–‡ä»¶
5. å¯¼å‡ºæ—¶æŒ‡å®šæ–°é…ç½®ï¼š
   ```bash
   python3 tools/thesis-to-docx-enhanced.py \
     --style "templates/docx-styles-<new-school>.json"
   ```

### æ‰¹é‡å¯¼å‡ºå¤šä¸ªæ ¼å¼ç‰ˆæœ¬
```bash
# ä¸ºä¸åŒå­¦æ ¡å¯¼å‡ºä¸åŒæ ¼å¼
for school in schoolA schoolB schoolC; do
  python3 tools/thesis-to-docx-enhanced.py \
    --style "templates/docx-styles-${school}.json" \
    --output "paper/è®ºæ–‡-${school}.docx"
done
```

### ç”ŸæˆPDFç‰ˆæœ¬
```bash
# ä½¿ç”¨ LibreOffice è½¬æ¢
soffice --headless --convert-to pdf \
  --outdir paper/ \
  paper/<PROJECT_NAME>è®ºæ–‡-å®Œæ•´ç‰ˆ.docx
```

---

## ğŸ“– ç›¸å…³å·¥å…·æ–‡æ¡£

### word-to-screenshots.py
```bash
python3 tools/word-to-screenshots.py <word_file> <output_dir> [dpi]
```
- word_file: Wordæ–‡æ¡£è·¯å¾„ï¼ˆ.docæˆ–.docxï¼‰
- output_dir: è¾“å‡ºç›®å½•
- dpi: åˆ†è¾¨ç‡ï¼ˆé»˜è®¤150ï¼Œå»ºè®®300ï¼‰

### thesis-to-docx-enhanced.py
```bash
python3 tools/thesis-to-docx-enhanced.py \
  [--style STYLE_FILE] \
  [--output OUTPUT_FILE] \
  [--project PROJECT_ROOT]
```
- style: æ ·å¼é…ç½®æ–‡ä»¶ï¼ˆé»˜è®¤: templates/docx-styles-yxnu.jsonï¼‰
- output: è¾“å‡ºæ–‡ä»¶ï¼ˆé»˜è®¤: paper/<PROJECT_NAME>è®ºæ–‡-å®Œæ•´ç‰ˆ.docxï¼‰
- project: é¡¹ç›®æ ¹ç›®å½•ï¼ˆé»˜è®¤: è„šæœ¬çˆ¶ç›®å½•ï¼‰

---

## ğŸ¯ æœ€ä½³å®è·µ

1. **å…ˆå°èŒƒå›´æµ‹è¯•**: å…ˆç”¨å‡ ä¸ªç« èŠ‚æµ‹è¯•å¯¼å‡ºæ•ˆæœï¼ŒéªŒè¯æ ¼å¼æ­£ç¡®åå†å…¨é‡å¯¼å‡º
2. **ç‰ˆæœ¬æ§åˆ¶**: æ¯æ¬¡å¯¼å‡ºå‰å¤‡ä»½ä¸Šä¸€ç‰ˆæœ¬ï¼Œä¾¿äºå¯¹æ¯”
3. **åˆ†é˜¶æ®µæ£€æŸ¥**: å¯¼å‡ºåç«‹å³æ£€æŸ¥å›¾è¡¨ç¼–å·ã€æ ·å¼åº”ç”¨æ˜¯å¦æ­£ç¡®
4. **ä½¿ç”¨Gitè¿½è¸ª**: å°†æ ·å¼é…ç½®å’Œå·¥å…·è„šæœ¬çº³å…¥ç‰ˆæœ¬æ§åˆ¶
5. **æ–‡æ¡£åŒ–é…ç½®**: åœ¨æ ·å¼JSONä¸­æ·»åŠ æ³¨é‡Šè¯´æ˜å„é¡¹å«ä¹‰
6. **ç»Ÿä¸€å‘½åè§„èŒƒ**: æ ·å¼æ–‡ä»¶ã€æ ¼å¼åˆ†ææ–‡ä»¶ä½¿ç”¨ç»Ÿä¸€çš„å‘½åè§„èŒƒ

---

## ğŸŒŸ é€šç”¨æ€§ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šç‰æºªå¸ˆèŒƒå­¦é™¢ + é£Ÿå ‚è¯„ä»·ç³»ç»Ÿ
```bash
# å˜é‡é…ç½®
SCHOOL_NAME="ç‰æºªå¸ˆèŒƒå­¦é™¢"
SCHOOL_ABBR="yxnu"
PROJECT_NAME="é£Ÿå ‚è¯„ä»·ç³»ç»Ÿ"

# å¯¼å‡ºå‘½ä»¤
python3 tools/thesis-to-docx-enhanced.py \
  --style "templates/docx-styles-yxnu.json" \
  --output "paper/é£Ÿå ‚è¯„ä»·ç³»ç»Ÿè®ºæ–‡-å®Œæ•´ç‰ˆ.docx"
```

### ç¤ºä¾‹2ï¼šäº‘å—å¤§å­¦ + å›¾ä¹¦ç®¡ç†ç³»ç»Ÿ
```bash
# å˜é‡é…ç½®
SCHOOL_NAME="äº‘å—å¤§å­¦"
SCHOOL_ABBR="ynu"
PROJECT_NAME="å›¾ä¹¦ç®¡ç†ç³»ç»Ÿ"

# å¯¼å‡ºå‘½ä»¤
python3 tools/thesis-to-docx-enhanced.py \
  --style "templates/docx-styles-ynu.json" \
  --output "paper/å›¾ä¹¦ç®¡ç†ç³»ç»Ÿè®ºæ–‡-å®Œæ•´ç‰ˆ.docx"
```

---

**æœ€åæ›´æ–°**: 2025-10-01
**å®ç°çŠ¶æ€**: âœ… å®Œå…¨å®ç°
**é€šç”¨æ€§**: âœ… æ”¯æŒå¤šå­¦æ ¡ã€å¤šé¡¹ç›®
**ä¾èµ–å·¥å…·**: LibreOffice, Poppler, rsvg-convert, python-docx
