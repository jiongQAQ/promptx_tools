# ğŸ“„ PRDï¼šåŸºäº JSON + å·¥ä½œæµçš„è®ºæ–‡ç”Ÿæˆç³»ç»Ÿ

## 1. é¡¹ç›®èƒŒæ™¯
å½“å‰éœ€æ±‚æ˜¯æ„å»ºä¸€ä¸ªâ€œæ— åå°ä»£ç é€»è¾‘â€çš„è®ºæ–‡ç”Ÿæˆå¹³å°ï¼Œ  
ä¸€åˆ‡æ•°æ®é€šè¿‡ JSON æ–‡ä»¶ç»„ç»‡ï¼Œæ‰§è¡Œæµç¨‹ç”±å·¥ä½œæµé©±åŠ¨ã€‚  
Claude Codeï¼ˆç®€ç§° CCï¼‰ç›´æ¥è¯»å–æºç ç›®å½•ä¸ JSON æ–‡ä»¶ï¼Œè¾“å‡ºè®ºæ–‡å†…å®¹ï¼›  
å›¾è¡¨ç”Ÿæˆé€šè¿‡å¤–æŒ‚å·¥å…·ï¼ˆå¦‚é²ç­ UML æ¸²æŸ“ã€ä¸‰çº¿è¡¨å·¥å…·ï¼‰ï¼›  
æœ€ç»ˆç”± Word å·¥å…·æ¶ˆè´¹ content.json ç”Ÿæˆ DOCXã€‚

---

## 2. é¡¹ç›®ç›®æ ‡
1. **å¤§çº²é©±åŠ¨**ï¼šè®ºæ–‡ç»“æ„ç”± outline.json ç¡®å®šï¼Œä¿è¯ç« èŠ‚ä¸€è‡´æ€§ã€‚
2. **å†…å®¹å¡«å……**ï¼šcontent.json å­˜å‚¨æ­£æ–‡ã€å›¾ã€è¡¨è®¡åˆ’ä¸ç”Ÿæˆç»“æœã€‚
3. **é¢„å®¡æœºåˆ¶**ï¼šå…ˆé¢„å¡« content.jsonï¼ˆåªå†™è®¡åˆ’ä¸æç¤ºè¯ï¼‰ï¼Œç”±ç”¨æˆ·å®¡æŸ¥ï¼›å†ç”Ÿæˆæ­£æ–‡/å›¾/è¡¨ã€‚
4. **æºç é©±åŠ¨**ï¼šä¸å†ä¸Šä¼ èµ„æ–™åº“ï¼ŒCC ç›´æ¥è§£è¯»æºç ã€‚
5. **è‡ªåŠ¨åŒ–å·¥ä½œæµ**ï¼šinit â†’ prefill â†’ run â†’ exportï¼Œå…¨æµç¨‹ JSON æ§åˆ¶ã€‚
6. **ç¨³å®šå¯¼å‡º**ï¼šæ— è®ºå›¾/è¡¨æ˜¯å¦å¤±è´¥ï¼ŒWord å·¥å…·å¯å¯¼å‡ºå®Œæ•´ DOCXã€‚

---

## 3. ç³»ç»Ÿæµç¨‹

### 3.1 æ–‡ä»¶ä¸ç›®å½•

/templates/
outline.template.json
content.template.json

/projects//
source/                  # ä¸Šä¼  zip è§£å‹æºç 
paper/
outline.json           # ä»æ¨¡æ¿å¤åˆ¶åç¼–è¾‘
content.json           # CC å¡«å†™æ­£æ–‡/å›¾/è¡¨
status.json            # çŠ¶æ€è®°å½•ï¼ˆå¯é€‰ï¼‰
exports/
images/              # å­˜ UML å›¾
docx/                # å­˜æœ€ç»ˆ Word

### 3.2 æµç¨‹æ­¥éª¤
1. ä¸Šä¼ æºç  zip â†’ è§£å‹åˆ° `/projects/<name>/source`ã€‚
2. æ‹·è´æ¨¡æ¿ JSON â†’ `/projects/<name>/paper/outline.json` + `content.json`ã€‚
3. Web é¡µé¢ï¼šç¼–è¾‘ `outline.json`ï¼ˆå¤§çº²ï¼‰ã€‚
4. è¿è¡Œ **prefill-content**ï¼š
    - CC è¯»å–å¤§çº² + æ¨¡æ¿ï¼Œä¸ºæ¯ç« ç”Ÿæˆ planï¼ˆæ˜¯å¦è¦æ­£æ–‡/å›¾/è¡¨ï¼‰+ æç¤ºè¯ã€‚
    - ç”¨æˆ·å®¡æŸ¥/ä¿®æ”¹ã€‚
5. è¿è¡Œ **run-paper**ï¼š
    - CC æ ¹æ® plan ç”Ÿæˆæ­£æ–‡ã€‚
    - éœ€è¦å›¾æ—¶ç”Ÿæˆ PlantUML å¹¶è°ƒç”¨é²ç­æ¸²æŸ“ï¼Œå†™å…¥ imagePathã€‚
    - éœ€è¦è¡¨æ—¶ç”Ÿæˆ JSON è¡Œåˆ—ï¼Œå†™å…¥ tablesã€‚
    - æ‰€æœ‰ç»“æœå†™å› content.jsonã€‚
6. è¿è¡Œ **export**ï¼š
    - Word å·¥å…·è¯»å– content.json â†’ å¯¼å‡º DOCXã€‚
    - å›¾å¤±è´¥æ’å…¥å ä½ç¬¦ï¼Œè¡¨å¤±è´¥æ’å…¥å ä½æ–‡æœ¬ã€‚

---

## 4. JSON æ–‡ä»¶

### 4.1 outline.json
æ ‘å½¢ç»“æ„å­˜å¤§çº²ï¼Œç« èŠ‚ ID ä¸æ ‡é¢˜ã€‚
```json
{
  "title": "è®ºæ–‡å¤§çº²",
  "nodes": [
    { "id": "1", "title": "ç¬¬1ç«  ç»ªè®º", "children": [...] }
  ]
}

4.2 content.json

æ¯ä¸ªç« èŠ‚ä¸€æ¡è®°å½•ï¼ŒåŒ…å«æ­£æ–‡ã€å›¾ã€è¡¨ã€è®¡åˆ’ã€‚

{
  "docId": "paper-001",
  "meta": { "title": "XXXç³»ç»Ÿè®¾è®¡ä¸å®ç°", "theme": "YYYä¸»é¢˜" },
  "contents": {
    "3.2": {
      "status": "planning",
      "plan": {
        "wantText": true,
        "wantFigure": true,
        "figurePlan": [
          { "enabled": true, "figureTitle": "ç³»ç»Ÿè½¯ä»¶é€»è¾‘æ¶æ„å›¾", "figureFocus": "åˆ†å±‚ä¸ä¾èµ–" }
        ],
        "wantTable": false,
        "tablePlan": []
      },
      "textPrompt": "æ’°å†™ã€Šç³»ç»Ÿè½¯ä»¶é€»è¾‘æ¶æ„ã€‹â€¦",
      "text": "",
      "figures": [],
      "tables": []
    }
  }
}

4.3 status.jsonï¼ˆå¯é€‰ï¼‰

è®°å½•æ¯æ¬¡æ‰§è¡ŒçŠ¶æ€ã€‚

{
  "lastInitAt": "2025-09-23T09:00:00Z",
  "lastPrefillAt": "2025-09-23T09:10:00Z",
  "lastGenerateAt": "2025-09-23T09:15:00Z",
  "failures": { "figures": ["Fig-3-2-1"], "tables": [] }
}


â¸»

5. æç¤ºè¯

5.1 åˆå§‹åŒ–

init
å…¨é¢é˜…è¯» projects/<name>/sourceï¼Œè¯†åˆ«è¯­è¨€ã€æ¡†æ¶ã€æ¨¡å—ã€æ•°æ®åº“ï¼Œè¾“å‡ºæ¨¡å—æ¸…å•ä¸è¦ç‚¹åˆ°å†…å­˜ï¼Œç”¨äºåç»­ç”Ÿæˆã€‚

5.2 é¢„å¡«

prefill-content
æ ¹æ® outline.json å’Œ content.template.jsonï¼Œä¸ºæ¯ä¸ªç« èŠ‚ç”Ÿæˆ content.jsonï¼š
1. ä¸ç”Ÿæˆæ­£æ–‡ã€å›¾æˆ–è¡¨ï¼Œåªç”Ÿæˆ plan ä¸æç¤ºè¯ã€‚
2. æ ¹æ®ç« èŠ‚æ ‡é¢˜å’Œæºç ç‰¹å¾ï¼Œå†³å®š wantFigure/wantTableã€‚
3. ä¸º figurePlan/tablePlan å¡«å†™ figureTitle/figureFocus/schemaã€‚
4. status=planningã€‚

5.3 æ­£å¼ç”Ÿæˆ

run-paper
è¯»å– content.json å’Œæºç ï¼š
1. ä¸º plan.wantText çš„ç« èŠ‚ç”Ÿæˆæ­£æ–‡ textã€‚
2. ä¸º enabled çš„ figurePlan ç”Ÿæˆ PlantUML â†’ è°ƒé²ç­æ¸²æŸ“ â†’ å†™å…¥ figures[]ã€‚
3. ä¸º enabled çš„ tablePlan ç”Ÿæˆ JSON æ•°æ® â†’ å†™å…¥ tables[]ã€‚
4. status=generatedï¼Œå¤±è´¥æ ‡è®° failedã€‚
5. è°ƒç”¨ Word å·¥å…·å¯¼å‡º DOCXã€‚


â¸»

6. å·¥å…·ç±»

6.1 é²ç­ UML æ¸²æŸ“
	â€¢	è¾“å…¥ï¼špuml æ–‡ä»¶
	â€¢	è¾“å‡ºï¼špng æ–‡ä»¶
	â€¢	å‘½ä»¤ï¼š

luban-uml render --in <pumlè·¯å¾„> --out <pngè·¯å¾„>

6.2 ä¸‰çº¿è¡¨å·¥å…·ï¼ˆå¯é€‰ï¼‰
	â€¢	è¾“å…¥ï¼šsql/schema
	â€¢	è¾“å‡ºï¼šjsonï¼ˆschema+rowsï¼‰
	â€¢	å‘½ä»¤ï¼š

three-line-gen --in schema.sql --out tab.json

6.3 Word å·¥å…·
	â€¢	è¾“å…¥ï¼šcontent.json + outline.json
	â€¢	è¾“å‡ºï¼špaper.docx
	â€¢	å‘½ä»¤ï¼š

word-export --content content.json --outline outline.json --out paper.docx


â¸»

7. é¡µé¢è®¾è®¡

é¡µé¢ Aï¼šå¤§çº²ç¼–è¾‘
	â€¢	æ ‘å½¢ç»“æ„ï¼Œå¢åˆ æ”¹æ‹–æ‹½ã€‚
	â€¢	ä¿å­˜åˆ° outline.jsonã€‚

é¡µé¢ Bï¼šå†…å®¹ç¼–è¾‘
	â€¢	Tabï¼šæ­£æ–‡ã€å›¾ã€è¡¨ã€è®¡åˆ’ã€‚
	â€¢	å¯æ‰‹åŠ¨ä¿®æ”¹ planï¼ˆæ˜¯å¦è¦å›¾/è¡¨ï¼‰ã€æç¤ºè¯ã€‚
	â€¢	ç»“æœå®æ—¶ä¿å­˜åˆ° content.jsonã€‚

é¡µé¢ Cï¼šæ‰§è¡Œä¸å¯¼å‡º
	â€¢	æŒ‰é’®ï¼šinit / prefill / run / exportã€‚
	â€¢	æ˜¾ç¤º status.json æ‰§è¡Œæ—¥å¿—ã€‚
	â€¢	æ˜¾ç¤ºå¤±è´¥æ¸…å•ï¼ˆå“ªäº›å›¾/è¡¨ç”Ÿæˆå¤±è´¥ï¼‰ã€‚

â¸»

8. éåŠŸèƒ½éœ€æ±‚
	1.	å®¹é”™ï¼šå›¾/è¡¨å¤±è´¥ä¸å½±å“å¯¼å‡ºã€‚
	2.	æ‰©å±•æ€§ï¼šæ”¯æŒæ›¿æ¢ UML æ¸²æŸ“å·¥å…·ã€ä¸‰çº¿è¡¨å·¥å…·ã€‚
	3.	ä¸€è‡´æ€§ï¼šoutline.json ä¸ content.json çš„ç« èŠ‚ ID ä¸€ä¸€å¯¹åº”ã€‚
	4.	æ€§èƒ½ï¼šåƒè¡Œæºç é¡¹ç›®ï¼Œç”Ÿæˆæ—¶é—´ < 5 åˆ†é’Ÿã€‚

â¸»

9. é‡Œç¨‹ç¢‘
	â€¢	M1ï¼šä¸Šä¼ æºç  + å¤§çº²ç¼–è¾‘ + content.json é¢„å¡«ã€‚
	â€¢	M2ï¼šCC å¡«æ­£æ–‡ + è°ƒç”¨é²ç­ç”Ÿå›¾ã€‚
	â€¢	M3ï¼šä¸‰çº¿è¡¨ç”Ÿæˆ + Word å¯¼å‡ºã€‚
	â€¢	M4ï¼šä¼˜åŒ– UI + åŠ çŠ¶æ€è¿½è¸ªã€‚

---

